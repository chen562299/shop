(function(j,d,u,e,l){var b={};e.sortAllZoneModule=function(){j(".elemZoneModule").each(function(H,I){h(j(I))})};e.sortModuleZone=function(){h(j("#fk-webHeaderZone"));h(j("#fk-webBannerZone"));h(j("#fk-webFooterZone"));h(j(".fk-inBannerListZone"))};e.sortPackModule=function(){j(".J_packContent").each(function(H,I){h(j(I))})};e.sortOneZoneModule=function(H){var I=H.hasClass("elemZoneModule")?H:H.find(".elemZoneModule");if(I.length>0){h(I)}};e.changeZoneEditPrompt=function(H,I){F(H,I)};e.initAllPackAddModuleBtn=function(){j(".J_packContent").each(function(H,I){q(this)})};e.initAddModuleBtn=function(H){if(H.length>0){q(H)}};e.refreshZoneEditBtn=function(H){v(H)};e.refreshFooterHeight=function(){a()};e.refreshFooterHeightForManage=function(H){a();Fai.top._footerStyleChanged++;Site.styleChanged();Site.setRefreshInfo("siteStyleSetting",true);Site.scrollToModuleDiv(H)};function h(H){H.sortable("destroy");H.sortable({items:'.form:not(".formUnsortable")',cancel:'.formLockEdit, input, textarea, select, .formUnsortable, embed[type="application/x-shockwave-flash"], object[type="application/x-shockwave-flash"], .addNewModule, .siteFormMiddle, .msgPanel_N, .msgAddText_N, .msgCaptcha_N, .msgAddButton_N',connectWith:".elemZoneModule:visible, .J_moduleZone:visible, .column:visible, .J_packContent:visible, .formTabButtonList,.formTabButtonYList,.formTabContent,.fullmeasureContent:visible,.J_placeholderStyle",distance:3,tolerance:"pointer",dropOnEmpty:true,scrollSensitivity:100,placeholder:"g_middlePlaceholder",zIndex:0,smartguides:".form:not(.moduleSortableHelper)",create:function(I,J){x(this);z(this)},beforeStart:function(I,J){H.sortable("option","smartguides",".form:not(.moduleSortableHelper)");if(d.getFrom()=="drag"){m(I,J,this)}else{if(Fai.top.dragToAddModule){H.sortable("option","smartguides","");i(I,J,this)}else{o(I,J,this)}}},start:function(I,J){if(j(J.item).hasClass("formStyle97")||Site.isCartModule(j(J.item))){if(j(J.item).hasClass("formStyle97")){H.sortable("option","connectWith",".J_moduleZone:visible:not(.fk-inBannerListZone), .J_packContent:visible, .elemZone:visible")}else{H.sortable("option","connectWith",".J_moduleZone:visible, .J_packContent:visible, .elemZone:visible")}}else{H.sortable("option","connectWith",".elemZoneModule:visible, .J_moduleZone:visible, .column:visible, .J_packContent:visible, .formTabButtonList,.formTabButtonYList,.formTabContent,.fullmeasureContent:visible,.J_placeholderStyle")}if(d.getFrom()=="drag"){}else{if(Fai.top.dragToAddModule){B(I,J,this)}else{f(I,J,this)}}},over:function(I,J){if(d.getFrom()=="drag"){}else{if(Fai.top.dragToAddModule){t(I,J,this)}else{D(I,J,this)}}},out:function(I,J){if(d.getFrom()=="drag"){E(I,J,this)}else{if(Fai.top.dragToAddModule){A(I,J,this)}else{y(I,J,this)}}},sort:function(I,J){if(d.getFrom()=="drag"){r(I,J,this)}else{if(Fai.top.dragToAddModule){}else{p(I,J,this)}}},receive:function(I,J){if(e.isZoneDisableModule(J.item)){if(Fai.top.dragToAddModule){w(I,J,this);Fai.ing("添加失败，容器内无法添加排版模块，请移动到其他位置",200)}else{Fai.ing("移动失败，容器内无法添加排版模块，请移动到其他位置",200)}J.sender.sortable("cancel");v(this);Fai.top._cancelAdd=true;return}else{Fai.top._cancelAdd=false}if(d.getFrom()=="drag"){C(I,J,this)}else{if(!J.placeholder){return}if(Fai.top.dragToAddModule){w(I,J,this)}else{n(I,J,this)}}},update:function(I,J){if(d.getFrom()=="drag"){}else{if(!J.placeholder){return}}},beforeStop:function(I,J){if(d.getFrom()=="drag"){}else{if(Fai.top.dragToAddModule){s(I,J,this)}else{G(I,J,this)}}},stop:function(I,J){if(d.getFrom()=="drag"){k(I,J,this)}else{if(!J.placeholder){return}if(Fai.top.dragToAddModule){return c(I,J,this)}else{Site.logDog(200084,1);return g(I,J,this)}}}})}function x(J){var K="",P=j(J),L,M,N,I=P.attr("id"),O="放入容器中",H="模块已拖出容器";if(I=="fk-webHeaderZone"){O="放入顶部中";H="模块已拖出顶部"}else{if(I=="fk-webBannerZone"||P.hasClass("fk-inBannerListZone")){O="放入横幅中";H="模块已拖出横幅"}else{if(I=="fk-webFooterZone"){O="放入底部中";H="模块已拖出底部"}else{if(I.indexOf("fk-packContent")>-1){O="放入自由容器中";H="模块已拖出自由容器！"}}}}if(P.children(".J_zoneEditTip").length<1){K+="<div class='J_zoneEditTip f-zoneEditTip' style='display:none;'>";K+="<div class='f-zoneEditTipBg'></div>";K+="<div class='J_zoneOverEdit f-zoneOverEdit' style='display:none;'>";K+="<span>"+O+"</span>";K+="</div>";K+="<div class='J_zoneOutEdit f-zoneOutEdit' style='display:none;'>";K+="<div class='f-tipDiv'>";K+="<span class='f-tipText'>"+H+"</span>";K+="<div class='f-tipDivBg'></div>";K+="</div>";K+="</div>";K+="<div class='J_zoneOverDisable f-zoneOverDisable' style='display:none;'>";K+="<span>容器内不支持添加排版模块，请重新添加到其他位置</span>";K+="</div>";K+="</div>";P.append(K)}L=P.children(".J_zoneEditTip");M=L.children(".J_zoneOverEdit");N=L.children(".J_zoneOutEdit");P.data("zoneEditTip",L);P.data("zoneOverEdit",M);P.data("zoneOutEdit",N)}function z(L){var K="",I=j(L),H,J;if(I.children(".J_zoneDisableTip").length<1){K+="<div class='J_zoneDisableTip f-zoneDisableTip' style='display:none;'>";K+="<div class='f-zoneDisableTipBg'></div>";K+="<div class='J_zoneOverDisable f-zoneOverDisable' style='display:none;'>";K+="<span>容器内不支持添加排版模块，请重新添加到其他位置</span>";K+="</div>";K+="</div>";I.append(K)}H=I.children(".J_zoneDisableTip");J=H.children(".J_zoneOverDisable");I.data("zoneDisableTip",H);I.data("zoneOverDisable",J)}function q(M){var J="",H=j(M).hasClass("elemZoneModule")?j(M):j(M).find(".J_packContent"),I="",L="";if(H.children(".J_zoneEditBtn").length>0){v(M);return}var K="jzUtils.run({'name':'faiFloatPanel'}, 0);";K+="jzUtils.run({'name':'panelDisableArea.createDisableMask'});";if(Fai.top._Global._topBarV2){K="jzUtils.run({'name':'goToFunPanel'});"}if(H.find(".form").length>0){L="style='display:none;'"}I+="Fai.top._appendArea='"+H.attr("id")+"';";I+="Fai.top._appendModule=-1;";I+="Fai.top.choiceAppendLocation=1;";I+=K;I+="Site.inFullmeasueAnimation.fmAddModuleStopCarousel("+H.attr("id").replace("elemZone","").replace("fk-packContent","")+");";J+="<div class='J_zoneEditBtn f-zoneEditBtn' "+L+">";J+="<div class='J_addContent f-addContent'>";J+="<div class='f-addDiv' onclick=\""+I+'"></div>';J+="<div class='f-addText' onclick=\""+I+'"><span>容器内模块可以随意拖动哦<span></div>';J+="</div>";J+="</div>";H.append(J)}function v(I){var H=j(I).hasClass("elemZoneModule")?j(I):j(I).find(".J_packContent");if(H.children(".form:not('.J_floatDragModuleHelper')").length>0){H.children(".J_zoneEditBtn").hide()}else{H.children(".J_zoneEditBtn").show()}}function o(K,M,O){var J=j(M.item),L=Site.checkNestModule(J),H=j(O),I=H.attr("id"),N;J.append("<div class='J_moduleOverlay fk-moduleOverlay'></div>");Site.disableEditLayer();Fai.stopInterval(null);Fai.top.$("body").disableSelection();Fai.top.$("#g_main").find(".g_middlePlaceholder").remove();Fai.top.$(".fillContentRelative").css("z-index","10");if(J.hasClass("formStyle32")){J.attr("_width",J.width())}j(".formTabCntId").sortable("option","disabled",true);j(".formTabCntId").children(".form").addClass("formUnsortable");j(".formTab").sortable("option","disabled",true);j(".column .form, .floatForms .form, .absForms .form").each(function(){if(j(this).hasClass("formStyle35")){j(this).find(".form .formTab").removeClass("column")}});if(L.parentId>0){Site.setModuleAttrDataChange(L.parentId)}d.setOriginalParentId(I);d.setOriginalParent(H);d.setCloneHelper(Site.sortableHelper.cloneHelper(M,K));d.getCloneHelper().css("opacity",0.8);d.setReceiveId(I);d.setReceiveParent(H);d.setOverParentId(I);d.setOverParent(H);d.setPrevModule(J.prevAll(".form").first());d.setFrom("elemZone");d.setWidth(J.width());d.setHeight(J.height())}function f(H,I,J){if(d.getOriginalParentId()==j(J).attr("id")){j(I.helper).show();d.getCloneHelper().hide()}else{j(I.helper).hide();d.getCloneHelper().show()}j(J).sortable("refresh")}function D(K,L,M){var I=j(M),H=I.attr("id"),J=d.getOverParent();d.setOverParentId(H);d.setOverParent(I);F("over",M,L.item)}function y(H,I,J){F("out",J);if(d.getOriginalParentId()!=j(J).attr("id")){j(I.helper).hide();d.getCloneHelper()&&d.getCloneHelper().show();F("originZoneOut",J)}else{j(I.helper).show();d.getCloneHelper()&&d.getCloneHelper().hide()}}function p(ab,Z,R){j(".moduleSortableHelperWrap").show();Site.sortableHelper.cloneHelperMove(Z);if(j(Z.helper).hasClass("formStyle97")||Site.isCartModule(j(Z.helper))||!Site.hasCommonForms()){var K=j(Z.item),aa=K.width(),Y=K.height(),W=d.getOriginalParent(),N=W.width(),P=W.height(),ad=W.offset().left,J=W.offset().top,ac=Z.offset.left,Q=Z.offset.top;moduleMoveOffset=Z.offset;if(d.getOriginalParentId()==d.getOverParentId()){if((ac+aa<ad)||(ac>ad+N)||(Q+Y<J)||(Q>J+P)){d.getCloneHelper()&&d.getCloneHelper().show();F("originZoneOut",R);return}else{j(Z.helper).show();d.getCloneHelper()&&d.getCloneHelper().hide()}}}else{if(d.getOriginalParentId()==d.getOverParentId()){j(Z.helper).show();d.getCloneHelper()&&d.getCloneHelper().hide()}else{j(Z.helper).hide();d.getCloneHelper()&&d.getCloneHelper().show();F("originZoneOut",R)}}var O=j(Z.placeholder);var S=O.parent();var V=j(".formTabButtonList"),X=j(".formTabButtonYList"),M=j(".formTabCntId");if(V.find(".g_middlePlaceholder").length>0){O.addClass("g_middlePlaceholder2")}else{O.removeClass("g_middlePlaceholder2")}if(X.find(".g_middlePlaceholder").length>0){O.addClass("g_middlePlaceholder2")}else{O.removeClass("g_middlePlaceholder2")}if(M.find(".g_middlePlaceholder").length>0){O.addClass("g_middlePlaceholder2")}else{O.removeClass("g_middlePlaceholder2")}if(O.hasClass("g_middlePlaceholder2")){O.css({height:"26px",minHeight:"26px"})}if(S.hasClass("fullmeasureContent")){var I=S.attr("moduleid");if(typeof(I)!="undefined"&&I>0){var T=j("#module"+I).find(".fillContentRelative");if(!T.hasClass("J_fmFrHeight")){T.addClass("J_fmFrHeight");T.css("height",j("#module"+I).height()+O.height())}}}Site.repHolder(ab,Z,R);var L=O.height()||26;O.css({lineHeight:L+"px"});O.html("放在这里");if(S.hasClass("formTabContent")){var U="formTabButtonList"+(S.attr("id").replace("formTabContent","")||0);Fai.top.$("#"+U).prepend(O)}if(j(Z.helper).hasClass("formStyle97")){var H=j(Z.helper).attr("id").substring(6);j(".styleMall"+H).hide()}j(Z.item).find(".ui-resizable-handle").show();Fai.top.$(".J_fkEditor_tool").hide()}function n(I,Q,K){var N=j(K),O=N.attr("id");d.setReceiveId(O);d.setReceiveParent(N);d.setReceive("elemZone");var L=d.getOriginalParent();var R=L.hasClass("J_packContent");var S=L.hasClass("J_moduleZone");var M=L.hasClass("elemZone");if(R||S||M){}else{var P=j(Q.item);var H=P.attr("_modulestyle");var J=Site.dragToAddModuleData.getWidth(H);d.setWidth(J)}}function G(I,J,K){var H=d.getCloneHelper();d.setStopOffset(H.offset());Site.sortableHelper.resetSortableHelper(J)}function g(aJ,av,aG){var K=j(av.item),W=K.parent(),au=parseInt(K.attr("id").replace("module","")),S=parseInt(K.attr("id").replace("module","")),X=Site.checkNestModule(K),P=0,aw=0,ai,aI,af,ay,H=K.width(),J=K.height(),at=d.getOriginalParent(),aB=at.width(),aD=at.height(),ax=at.offset().left,aj=at.offset().top,ah=d.getReceiveParent(),ag=d.getOriginalParentId(),aK=d.getReceiveId(),aq=ah.width(),aA=ah.height(),al=d.getPrevModule(),aa=20,V=false,O="formTabButtonList",aC,L,R,ak;K.children(".J_moduleOverlay").remove();if(K.hasClass("formStyle97")||Site.isCartModule(K)||!Site.hasCommonForms()){if(d.getOriginalParentId()==d.getOverParentId()){R=d.getStopOffset().left||moduleMoveOffset.left;ak=d.getStopOffset().top||moduleMoveOffset.top;if((R+H<ax)||(R>ax+aB)||(ak+J<aj)||(ak>aj+aD)){K.attr("id")&&Site.floatOut2(K.attr("id"),l,true);K.offset(d.getStopOffset());K.children(".J_moduleOverlay").remove();d.setOriginalParentId();F("reset",aG);if(d.getReceive()=="pack"){K.find(".mallHead").click().click()}else{K.find(".mallHead").click()}Site.enableEditLayer();Fai.top.$("body").enableSelection();Fai.startInterval(null);Site.refreshForms();j(".mulMColList").sortable("option","disabled",false);j(".mulMColList").addClass("column");j(".formTabCntId").sortable("option","disabled",false);j(".form").removeClass("formUnsortable");j(".formTabButtonList").sortable("option","disabled",false);j(".formTabButtonYList").sortable("option","disabled",false);j(".formTabContent").sortable("option","disabled",false);j(".formTab").sortable("option","disabled",false);Fai.top.$(".fillContentRelative").css("z-index","-1");return}}}j(".fullmeasureContent").each(function(aL,aM){j(aM).find(".tmpForm").remove()});F("reset",aG);Site.enableEditLayer();Fai.top.$("body").enableSelection();Fai.startInterval(null);if(d.getReceive()=="moduleZone"&&Site.isSystemModule(K)){Fai.ing("系统模块不能拖入当前区域",true);K.show();d.reset();return false}if(d.getReceive()=="pack"){v(ah)}if(d.getFrom()=="elemZone"){v(at)}if(d.getReceive()=="moduleZone"){ah.append(K)}if(W.hasClass("formTabButtonYList")){O="formTabButtonYList";V=true}Site.refreshForms();af=Site.checkNestModule(K);ay=Fai.top.$("#module"+af.parentId);if((af.inTab||W.hasClass(O))&&!W.hasClass("formTabContent")){d.setReceive("column");var ad=K.index();var aH=W.children(".formTabButton").length;if(ad>aH){ad=aH-1}if(W.hasClass(O)){L=parseInt(W.attr("id").replace("formTabButtonList",""))||L;K.attr("_intab",L);K.attr("_inmulmcol",0);K.attr("_infullmeasure",0);K.attr("_inpack",0);if(ad>0){Fai.top.$("#formTabContent"+L).children().eq((ad-1)).after(K)}else{Fai.top.$("#formTabContent"+L).prepend(K)}}var N=Fai.encodeHtml(K.find(".titleText .mainTitle").first().text());var am=parseInt(K.attr("_modulestyle"));if(am==79||am==81||am==86){if(j(av.item).find(".mainTitle").length<1){N=Fai.encodeHtml(K.attr("bannertitle"))}}N=N.replace(/<br\/>/,"");var T=K.attr("class").split(" "),Y,Q=false;for(var aF in T){if(/formStyle*/.test(T[aF])){Y=T[aF].substring(9)}}if(Y==3||Y==16){Q=true}Fai.top.$("#formTabButton"+S).remove();var az=[];az.push("<div class='formTabButton' id='formTabButton"+S+"' tabModuleId='"+S+"' onclick='Site.changeLiCnt("+S+", "+Q+", 29)'>");az.push("<div class='formTabLeft'></div>");az.push("<div class='formTabMiddle'>");if(V){az.push("<span class='tabButtonText'>")}az.push(N);if(V){az.push("</span>")}az.push("</div>");az.push("<div class='formTabRight'></div>");if(Fai.top._uiMode||Fai.top._isTemplateVersion2){az.push("<div class='tabItemTriangle'></div>")}az.push("</div>");var ap=Fai.top.$("#formTabButtonList"+L);if(ad>0){if(Fai.top._uiMode||Fai.top._isTemplateVersion2){az.unshift("<div class='tabItemSep'><div class='commonTabItemSep'></div></div>")}ap.children(".formTabButton").eq((ad-1)).after(az.join(""))}else{if(Fai.top._uiMode||Fai.top._isTemplateVersion2){if(ap.find(".formTabButton").length>0&&!ap.children().first().hasClass("tabItemSep")){az.push("<div class='tabItemSep'><div class='commonTabItemSep'></div></div>")}}ap.prepend(az.join(""))}if(ap.hasClass("formTabButtonYList")&&ap.find(".tabYListPlaceholder").length<1){ap.append(j("<td class='tabYListPlaceholder'></td>"))}var aE=200;var M=top.$("#formTabContent"+S).children(".formTabCntId");if(M.length>0){aE=M.first().height()}var ae="";if(aE){ae=" style='height:"+aE+"px !important;'"}if(!Fai.top.$("#module"+S).parent().hasClass("formTabCntId")&&!Fai.top.$("#module"+S).hasClass("formTabCntId")){Fai.top.$("#module"+S).wrap("<div class='formTabCntId' id='formTabCntId"+S+"'"+ae+"></div>")}Fai.top.Site.bindInTabSwitch();af=Site.checkNestModule(K);ay=Fai.top.$("#module"+af.parentId)}if(af.inTab){var U=Site.getModuleAttrPattern(S).border;if(U){U.y=1;Site.hideModuleBorder(S)}}if(d.getOriginalParentId()==d.getReceiveId()){P=av.position.top;aw=av.position.left}else{ai=d.getStopOffset();aI=d.getReceiveParent().offset();P=ai.top-aI.top;aw=ai.left-aI.left}if(j.inArray(K.attr("_modulestyle"),["39","45","62","65","66"])>-1&&j.inArray(d.getReceive(),["moduleZone","pack"])>-1){Site.oneKeySetModuleTB(S,true);d.setHeight(K.height())}if(d.getReceive()=="column"||d.getReceive()=="fullmeasure"){K.removeAttr("style");Site.dockModuleResize(K);if(K.attr("_autoheight")>0){Site.autoModuleHeight(au)}if(af.inTab){K.removeClass("formInMulMCol formInZone").addClass("formInTab");Site.dockModuleResize(ay)}else{if(af.inCol){K.removeClass("formInTab formInZone").addClass("formInMulMCol");Site.dockModuleResize(ay)}else{if(af.inFullmeasure){K.removeClass("formInTab formInMulMCol formInZone");Site.inFullmeasueAnimation.refFillRelativeDivHeight(af.parentId)}else{if(af.inPack){K.removeClass("formInTab formInMulMCol formInZone")}}}}var an=av.item;var ao=an.parents(".form");if(ao.length>0){ao=ao.eq(0)}var Z=ao.attr("id");if(ao.hasClass("formStyle35")){if(an.hasClass("formStyle35")){Fai.ing("多列排版模块不能插入多列排版模块之中",true);d.reset();return false}}if(ao.hasClass("formStyle29")){if(an.hasClass("formStyle35")){Fai.ing("多列排版模块不能插入标签模块之中",true);d.reset();return false}if(an.hasClass("formStyle29")){Fai.ing("标签模块不能插入标签模块之中",true);d.reset();return false}}if(an.hasClass("formStyle86")){Site.refreshSimpleEditor(an,an)}if(an.hasClass("formStyle32")){if(an.width()!=parseInt(an.attr("_width"))){an.find(".resize").each(function(){j(this).css({width:""});j(this).removeAttr("_width")});var ab=Site.getModuleAttr(S);ab.data.changed=true;Site.styleChanged()}}if(an.hasClass("formStyle75")){Site.fixMsgSubmitStyle(S)}if(an.hasClass("formStyle50")){Site.fixMsgBoardStyle(S)}if(j(av.item).parent().hasClass("formTabContent")){var I=j(av.item).parent().attr("id"),ac=parseInt(I.replace("formTabContent",""));Site.getModuleAttrData(ac).changed=true;Site.addModuleCallBackForTab(S,1,null,I,[],0,200);Fai.top.Site.bindInTabSwitch()}if(af.inTab){if(Fai.top.$("#module"+af.parentId).attr("_autoHeight")>0){Site.autoModuleHeight(af.parentId)}}}else{if(d.getReceive()=="moduleZone"){var ai=d.getStopOffset();var aI=d.getReceiveParent().offset();var P=ai.top-aI.top;var aw=ai.left-aI.left;var H=d.getWidth();var J=d.getHeight();Site.commPack.topModuleIndex(K);var ah=d.getReceiveParent();var aq=ah.width();var aA=ah.height();F("reset",ah);if(aw>=aq){aw=aq-H}else{if(aw<=(-H)){aw=0}}if(P>=aA){P=aA-J}else{if(P<=(-J)){P=0}}K.removeAttr("style");K.css({position:"absolute",top:P+"px",left:aw+"px",width:H+"px",height:J+"px"});if(K.attr("_modulestyle")==81){Site.adjustFlBtnPos(au)}e.resizable(K);if(K.attr("_autoheight")>0){Site.autoModuleHeight(au)}if(af.inZone){K.removeClass("formInTab formInMulMCol").addClass("formInZone")}if(X.parentId>0){Site.setModuleAttrDataChange(X.parentId)}if(K.hasClass("formStyle97")){K.find(".mallHead").click()}}else{if(aw>=aq-aa){aw=aq-H}else{if(aw<=(-H)+aa){aw=0}}if(P>=aA){P=aA-J}else{if(P<=(-J)+aa){P=0}}K.css({top:P+"px",left:aw+"px"});if(ag!=aK){Site.commPack.topModuleIndex(K)}else{if(al&&al.length>0){al.after(K)}else{ah.find(".J_zoneContentBg").after(K)}}if(K.hasClass("formStyle97")){var ar=K.attr("id").substring(6);j(".styleMall"+ar).show();K.find(".mallHead").click().click()}K.removeClass("formInTab formInMulMCol").addClass("formInZone");setTimeout(function(){Site.triggerGobalEvent("changeParentModuleHeightToAuto",{id:S})},0)}}if(X.inPack){Site.commPack.resetPackModuleHeight(X.parentId)}j(".mulMColList").sortable("option","disabled",false);j(".mulMColList").addClass("column");j(".formTabCntId").sortable("option","disabled",false);j(".form").removeClass("formUnsortable");j(".formTabButtonList").sortable("option","disabled",false);j(".formTabButtonYList").sortable("option","disabled",false);j(".formTabContent").sortable("option","disabled",false);j(".formTab").sortable("option","disabled",false);Fai.top.$(".fillContentRelative").css("z-index","-1");j(".elemZoneModule").sortable("option","disabled",false);K.show();if(X.parentId>0){Site.setModuleAttrDataChange(X.parentId)}if(af.parentId>0){Site.setModuleAttrDataChange(af.parentId)}if(d.getReceive()=="fullmeasure"){Site.inFullmeasueModuleEdit.autoResetFullmeasureHeight(d.getReceiveParent().attr("moduleid"));Site.inFullmeasueModuleEdit.checkContentBgPlace(K)}if(d.getFrom()=="fullmeasure"){Site.inFullmeasueModuleEdit.autoResetFullmeasureHeight(d.getOriginalParent().attr("moduleid"))}if(d.getReceiveId()=="fk-webFooterZone"){e.refreshFooterHeightForManage(K)}Fai.top._moduleMoved++;Site.styleChanged();Site.moduleSizeChange(K.attr("id"));Fai.top.originSortable="";d.reset();Site.moveSpecialModuleInNewPack(au);Site.moduleChangeParentCallback()}function F(H,K,J){var I=j(K);if(I.length<1){return}if(H=="over"){j(".J_zoneEditTip").hide();j(".J_zoneOverEdit").hide();j(".J_zoneOutEdit").hide();if(d.getOriginalParentId()==I.attr("id")){I.data("zoneEditTip")&&I.data("zoneEditTip").hide();I.data("zoneOverEdit")&&I.data("zoneOverEdit").hide();I.data("zoneOutEdit")&&I.data("zoneOutEdit").hide();I.data("zoneDisableTip")&&I.data("zoneDisableTip").hide();I.data("zoneOverDisable")&&I.data("zoneOverDisable").hide();clearTimeout(b.timer);delete b.timer;delete b.out;return}if(J&&e.isZoneDisableModule(J)){I.data("zoneDisableTip")&&I.data("zoneDisableTip").show();I.data("zoneOverDisable")&&I.data("zoneOverDisable").show();I.children(".J_zoneEditBtn").hide()}else{I.data("zoneEditTip")&&I.data("zoneEditTip").show();I.data("zoneOverEdit")&&I.data("zoneOverEdit").show();I.data("zoneOutEdit")&&I.data("zoneOutEdit").hide();I.children(".J_zoneEditBtn").hide()}}else{if(H=="out"){v(K);if(d.getOriginalParentId()==I.attr("id")){return}I.data("zoneEditTip")&&I.data("zoneEditTip").hide();I.data("zoneOutEdit")&&I.data("zoneOutEdit").hide();I.data("zoneOverEdit")&&I.data("zoneOverEdit").hide();I.data("zoneDisableTip")&&I.data("zoneDisableTip").hide();I.data("zoneOverDisable")&&I.data("zoneOverDisable").hide()}else{if(H=="originZoneOut"){if(!b.out&&d.getOriginalParentId()==I.attr("id")){I.data("zoneEditTip")&&I.data("zoneEditTip").show();I.data("zoneOverEdit")&&I.data("zoneOverEdit").hide();I.data("zoneOutEdit")&&I.data("zoneOutEdit").show();b.out=true;b.timer=setTimeout(function(){I.data("zoneOutEdit")&&I.data("zoneOutEdit").hide();I.data("zoneEditTip")&&I.data("zoneEditTip").hide();delete b.timer},3000)}}else{if(H=="reset"){clearTimeout(b.timer);delete b.timer;delete b.out;I.data("zoneEditTip")&&I.data("zoneEditTip").hide();I.data("zoneOutEdit")&&I.data("zoneOutEdit").hide();I.data("zoneOverEdit")&&I.data("zoneOverEdit").hide();I.data("zoneDisableTip")&&I.data("zoneDisableTip").hide();I.data("zoneOverDisable")&&I.data("zoneOverDisable").hide()}}}}}function i(J,L,M){var I=j(L.item),K,H,N;Fai.top.$("#g_main").find(".g_middlePlaceholder").remove();Site.disableEditLayer();Fai.stopInterval(null);Fai.top.$("body").disableSelection();Fai.top.dragInSortable=true;K="<div class='form tmpForm' style='width:100%;height:50px;background:none;border:none;padding:0;margin:0;'></div>";j(".fullmeasureContent").each(function(O,P){H=j(P);N=H.children(".form");if(N.length==0){H.data("_sortabletmpForm",j(K).prependTo(H))}});d.setOriginalParent(I)}function B(H,I,J){F("over",J,I.item)}function t(H,I,J){F("over",J,I.item)}function A(H,I,J){F("out",J)}function w(I,K,L){var J=j(L),H=J.attr("id");d.setReceiveId(H);d.setReceiveParent(J);d.setReceive("elemZone")}function s(H,I,J){d.setStopOffset(I.offset)}function c(I,M,J){var L,P,O;F("reset",J);if(!M.placeholder){return}if(d.getOriginalParent()==null){d.reset();return}j(".fullmeasureContent").each(function(R,S){L=j(S);P=L.data("_sortabletmpForm");O=L.data("_sortabletmpForm2");if(P){P.remove()}if(O){O.remove()}});Site.enableEditLayer();Fai.top.$("body").enableSelection();Fai.startInterval(null);j(".elemZoneModule").sortable("option","disabled",false);if(d.getReceive()!="elemZone"){return}Fai.top.addModule_insertBefore=false;Fai.top._appendModule=-1;Fai.top._appendArea=j(J).attr("id");Fai.top.draggableDiv_enable=false;var N=d.getStopOffset();var Q=d.getReceiveParent().offset();var K=N.top-Q.top;var H=N.left-Q.left;u.setPosition({top:K,left:H});d.reset()}function m(H,I,J){j(I.item).addClass("J_floatDragModuleHelper")}function E(H,I,J){F("out",J);j(I.helper).removeClass("fk-dragInZone");Site.floatData.reset()}function r(I,J,K){var H=j(J.item);if(H.hasClass("formStyle87")||H.hasClass("formStyle35")||H.hasClass("formStyle29")||H.hasClass("formStyle80")){return}F("over",K,J.item);j(J.helper).addClass("fk-dragInZone");Site.floatData.setDragIn("elemZone")}function C(I,K,L){var J=j(L),H=J.attr("id");d.setReceiveId(H);d.setReceiveParent(J);d.setReceive("elemZone")}function k(H,I,J){F("reset",J);j(I.item).remove();Site.moduleChangeParentCallback()}function a(){var T=0,H=Fai.top.$("#fk-webFooterZone").children(".form"),I=H.length,J=Fai.top.$("#webFooter"),N=J.find(".footerContent"),Q=J.height(),K=parseInt(N.css("paddingBottom").replace("px")),M=N.offset().top-J.offset().top,O=0,S=Fai.top.Site.getFooterStyleData(),R=S.f.t,P,L;if(R==1){return}if(I<1){S.f.d=0;Fai.top.Site.saveFooterStyleData(S);Fai.top._footerStyleChanged++;Site.styleChanged();Site.setRefreshInfo("siteStyleSetting",true);Fai.top.Fai.removeCtrlStyleCssList("stylefooter","footer",[{cls:".footerContent",key:"padding-bottom"}]);return}while(I){I-=1;L=H.eq(I);P=L.position().top+L.height();if(P>T){T=P}}O=T-Q+K+M;if(O<0){O=0}S.f.d=-O;Fai.top.Site.saveFooterStyleData(S);Fai.top.Fai.setCtrlStyleCssList("stylefooter","footer",[{cls:".footerContent",key:"padding-bottom",value:O+"px"}])}})(jQuery,(Fai.top.Site&&Fai.top.Site.sortData)||Site.sortData,(Fai.top.Site&&Fai.top.Site.dragToAddModuleData)||Site.dragToAddModuleData,Fai.top._elemZone||(Fai.top._elemZone={}));(function(b,f,e){f.resizeAllZoneModule=function(){var g=Fai.top.$(".elemZoneModule").children(".form");g.each(function(h,i){var j=b(i);j.on("mouseenter.resize",function(){if(j.children(".ui-resizable-handle").length>0){j.off("mouseenter.resize");return}a(b(j))})})};f.resizeOneZoneModule=function(h){var g=h.hasClass("elemZoneModule")?h.children(".form"):h.find(".elemZoneModule").children(".form");g.each(function(i,j){a(b(j))})};f.resizeModuleZone=function(){var h=Fai.top.$("#fk-webHeaderZone, #fk-webBannerZone, #fk-webFooterZone, .fk-inBannerListZone").children(".form"),g=h.length;while(g){g-=1;a(h.eq(g))}};f.resizeZoneOneModule=function(g){a(g)};f.disableResizeOneZoneModule=function(h){var g=h.children(".form");g.each(function(i,j){b(j).resizable("destroy");b(j).children(".ui-resizable-cancelTip").remove()})};f.packChildrenDisableResizable=function(h){var g=h.hasClass("elemZoneModule")?h.children(".form"):h.find(".J_packContent").children(".form");g.each(function(i,j){b(j).resizable("destroy");b(j).children(".ui-resizable-cancelTip").remove()})};f.isZoneDisableModule=function(g){if(g.hasClass("formStyle87")||g.hasClass("formStyle29")||g.hasClass("formStyle35")||g.hasClass("panelModuleIcon_pack")||g.hasClass("panelModuleIcon_tab")||g.hasClass("panelModuleIcon_mulModuleCol")){return true}return false};function a(m){var h=Site.absAlignLine;var i=m.attr("id");var g=i.replace("module","");var l=m.attr("_side");var q=Site.checkNestModule(m);var k=m.attr("_modulestyle");var r="",o="";var n;m.find(".ui-resizable-cancelTip").remove();if(m.hasClass("formStyle79")){var j=parseInt(b(m).find(".floatImg img").width());var p=parseInt(b(m).find(".floatImg img").height());m.css("width",j+"px");m.css("height",p+"px");Site.floatImgResize(m);return}else{if(m.hasClass("formStyle81")){Site.floatBtnResize(m);return}else{if(m.hasClass("formStyle82")){return}else{if(m.hasClass("formStyle86")){Site.simpleTextResize(m);return}}}}m.resizable("destroy");m.resizable({helper:"ui-resizable-helper",handles:"n, e, s, w, se, sw, ne, nw",autoHide:true,create:function(){if((b(this).attr("_autoHeight")==0)&&(b(this).children(".ui-resizable-cancelTip").length<1)){var y=b(this).attr("id").replace("module","");var x=b(this).find(".ui-resizable-se").css("z-index");var w="";if(b(this).hasClass("formStyle29")||b(this).hasClass("formStyle35")||b(this).hasClass("formStyle80")){w+=" ui-resizable-cancelTip2 fk-resizable-cancelTip2"}if(!b(this).hasClass("formStyle97")){b(this).append("<a href='javascript:;' class='J_resizableTip ui-resizable-cancelTip fk-resizable-cancelTip"+w+"' style='z-index:"+x+";' parentid='"+b(this).attr("id")+"' _faiscoTip='还原模块默认高度' onclick='Site.absModuleAutoHeight("+y+");return false;'></a>")}}if(k==45||k==62){b(this).resizable("option","minWidth",220);b(this).resizable("option","minHeight",62)}if(k==45||k==62){var u=b(this).find(".fk-newSearchBoxContainer"),t=Site.getModuleAttrPattern(y).searchBoxPattern,v=t.inputWidth||u.outerWidth(),s=t.inputHeight;b(this).data("searchWidth",v);if(s){b(this).data("searchHeight",s)}}Site.addResizableExtHandles(b(this));Site.refreshResizableHandles(b(this))},start:function(t,u){b(this).unbind("mouseenter",Site.bindSideIn1).unbind("mouseleave",Site.bindSideOut1).unbind("mouseenter",Site.bindSideIn2).unbind("mouseleave",Site.bindSideOut2);r=b(this).width();o=b(this).height();Site.disableEditLayer();Fai.top.$("body").disableSelection();if(b(this).hasClass("formStyle35")||b(this).hasClass("formStyle29")){b(this).attr("_mousein",1)}n=b("#dockTip").show();h.resize.begin=true;if(b(this).hasClass("formStyle83")){var w=b(this);b(u.originalElement).find("> .ui-resizable-handle").each(function(x,y){if(b(y).data("on")){if(b(y).hasClass("ui-resizable-nw")||b(y).hasClass("ui-resizable-ne")||b(y).hasClass("ui-resizable-sw")||b(y).hasClass("ui-resizable-se")){w.resizable("option","aspectRatio",true);return false}}else{w.resizable("option","aspectRatio",false)}})}if(b(this).hasClass("formStyle85")){var s=b(this);b(u.originalElement).find("> .ui-resizable-handle").each(function(x,y){if(b(y).data("on")){if(b(y).hasClass("ui-resizable-nw")||b(y).hasClass("ui-resizable-ne")||b(y).hasClass("ui-resizable-sw")||b(y).hasClass("ui-resizable-se")){s.resizable("option","aspectRatio",true);return false}}else{s.resizable("option","aspectRatio",false)}})}if(b(this).hasClass("formStyle98")){var v=b(this);b(u.originalElement).find("> .ui-resizable-handle").each(function(x,y){if(b(y).data("on")){if(b(y).hasClass("ui-resizable-nw")||b(y).hasClass("ui-resizable-ne")||b(y).hasClass("ui-resizable-sw")||b(y).hasClass("ui-resizable-se")){v.resizable("option","aspectRatio",true);return false}}else{v.resizable("option","aspectRatio",false)}})}},resize:function(s,A){var v=b(".ui-resizable-helper");b(this).find(".formMiddle").find(".formMiddleCenter").css("vertical-align","top");var B=["top","right","bottom","left"];h.resize.init(b(this),v,s,B);if(b(this).hasClass("formStyle35")||b(this).hasClass("formStyle29")){b(this).attr("_mousein",1)}n.html("高度:"+v.height()+"<br/>宽度:"+v.width()).css({left:s.pageX-28,top:s.pageY+18});if(b(this).hasClass("formStyle97")){var t=b(this).attr("id").substring(6);b(".styleMall"+t).hide()}if(k==45||k==62){var z=Site.getModuleAttrPattern(g),w=z.inputWidth,x=0,u=0,y=b(this).find(".fk-newSearchBoxContainer"),C=b(this).data("searchWidth");x=b(this).width()-A.originalSize.width;C+=x;if(x<0){y.width(C)}}},stop:function(E,z){var J=b(this).attr("_moduleid");var C=Site.checkNestModule(b(this));Site.protectZoneElemResizable(b(this));if(b(this).hasClass("formStyle35")||b(this).hasClass("formStyle29")){b(this).attr("_mousein",1)}var B=b(this).attr("id").replace("module","");if(b(this).children(".ui-resizable-cancelTip").length<1){var A=b(this).find(".ui-resizable-se").css("z-index");var I="";if(b(this).hasClass("formStyle29")||b(this).hasClass("formStyle35")||b(this).hasClass("formStyle80")){I+=" ui-resizable-cancelTip2 fk-resizable-cancelTip2"}if(!b(this).hasClass("formStyle97")){b(this).append("<a href='javascript:;' class='J_resizableTip ui-resizable-cancelTip fk-resizable-cancelTip"+I+"' style='z-index:"+A+";' parentid='"+b(this).attr("id")+"' _faiscoTip='还原模块默认高度' onclick='Site.absModuleAutoHeight("+B+");return false;'></a>")}}Site.styleChanged();Fai.top._moduleMoved++;Site.getModuleAttrPattern(B).changed=true;Site.setModuleAttrDataChange(C.parentId);b(z.originalElement).attr("_autoHeight",0);Site.refreshModuleHeight(B);if(l!=2){Site.refreshAbsFloatForm(b(this))}Site.refreshSideBtn(b(this));Site.enableEditLayer();Site.moduleSizeChange("module"+B);if(b(this).hasClass("formStyle5")||b(this).hasClass("formStyle77")){Site.refreshModulePhotoSwitch(B)}if(k==45||k==62){var D=Site.getModuleAttrPattern(B).searchBoxPattern,K=D.inputWidth,t=0,L=0,H=b(this).find(".J_newSearchBox"),w=b(this).find(".fk-newSearchBoxContainer"),s=b(this).find(".fk-searchBoxBtn"),x=s.find("span"),v=b(this).find(".fk-searchMenuWord"),G=H.attr("_type"),y=H.attr("_borderwidth"),F=b(this).data("searchWidth"),u=b(this).data("searchHeight")||H.outerHeight();t=b(this).width()-z.originalSize.width;L=z.size.height-z.originalSize.height;if(t!=0){F+=t;D.iw=F;b(this).data("searchWidth",F);w.width(F);if(G==4||G==7){Site.fixDynamicSearchMenu(B);if(s.data("unfold")){s.trigger("click")}}else{if(G==6){Site.fixDynamicSearchMenu(B);if(s.data("unfold")){s.trigger("click")}}}}if(L!=0){u+=L;b(this).data("searchHeight",u);if(G==1||G==3||G==8){y||(y=(G==1)?2:1);u-=y*2;D.ih=u;H.height(u);w.height(u-y*2);s.height(u);x.css("line-height",u+"px");v.css("line-height",u-y*2+"px")}else{if(G==2||G==5||G==9||G==10){y||(y=1);u-=y*2;D.ih=u;u-=y*2;H.height(u);w.height(u);s.height(u);x.css("line-height",u+"px");v.css("line-height",u+"px")}else{if(G==4||G==6||G==7){if(G==4){y||(y=1);u-=y;H.height(u);u-=y}else{if(G==6){y||(y=1)}else{if(G==7){y||(y=2);u-=y*2;H.height(u);u-=y*2}}}D.ih=u;w.height(u);s.height(u);x.css("line-height",u+"px");v.css("line-height",u+"px");Site.fixDynamicSearchMenu(B);if(s.data("unfold")){s.trigger("click")}}}}}}Fai.top.$("body").enableSelection();b(this).trigger("Fai_onModuleSizeChange");n.hide();c({module:b(this),parentId:C.realParentId});if(b(this).parent().hasClass("J_packContent")){Site.logDog(100092,6);Site.logDog(100045,64);Site.logDog(100092,0)}else{if(b(this).parent().hasClass("J_moduleZone")){Site.logDog(100092,7);Site.logDog(100092,0)}}Site.triggerGobalEvent("resizableModuleChange",B);Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom,#absAlignLeft").hide();if(b(this).hasClass("formStyle83")){Site.initPhotoCard(B)}if(b(this).hasClass("formStyle85")){Site.initPhotoNewCard(B)}if(b(this).hasClass("formStyle98")){if(b(this).width()<=400){b(this).css("height",o+"px");b(this).css("width",r+"px")}else{if(r!=b(this).width()){Site.initPhotoMoreCard(B,r)}else{Site.initPhotoMoreCard(B)}}}if(b(this).hasClass("formStyle97")){var J=b(this).attr("_moduleid");b(this).find(".mallHead").click();b(".styleMall"+J).stop(true,true).show()}Site.triggerGobalEvent("changeParentModuleHeightToAuto",{id:J})}});m.find(".formMiddle").find(".formMiddleCenter").css("vertical-align","top");m.children(".ui-resizable-handle").attr("_faiscoTip","按住鼠标，可随意调整宽高。").attr("parentid",i);m.children(".ui-resizable-topLine").attr({fkTipOffsetType:"mouse",fkTipXAlign:"center",fkTipY:10});m.children(".ui-resizable-bottomLine").attr({fkTipOffsetType:"mouse",fkTipXAlign:"center",fkTipY:10});m.children(".ui-resizable-leftLine").attr({fkTipOffsetType:"mouse",fkTipXAlign:"left",fkTipY:10});m.children(".ui-resizable-rightLine").attr({fkTipOffsetType:"mouse",fkTipXAlign:"right",fkTipY:10});m.find("> .ui-resizable-handle").bind("mousedown",function(t,s){b(this).data("on",true).siblings().data("on",false)});d(m)}function d(h){var i=h.attr("id").replace("module",""),g;if(h.hasClass("formStyle1")){g=h.find("img.richModuleSlaveImg"),i=h.attr("id").replace("module","");if(g.length>0){Site.richModuleSlaveImgResize(g);Site.richModulePicEdit(g)}}if(h.hasClass("formStyle88")||h.hasClass("formStyle89")||h.hasClass("formStyle90")){Site.moduleListPhotosItemManage.listPhotosImgResize(i)}else{if(h.hasClass("formStyle91")||h.hasClass("formStyle92")||h.hasClass("formStyle93")){Site.moduleCarouselPhotosItemManage.carouselPhotosImgResize(i)}}if(h.hasClass("formStyle98")){Site.bindInPhotoMoreCardResizable(i);Site.bindInPhotoMoreCardHighResizable(i)}}function c(j){var h=j.module,p=h.width(),m=h.height(),k=h.position(),g=k.left,i=k.top,q=Fai.top.$("#"+j.parentId),r=q.width(),l=q.height(),o=false,n=false;if(g>=r){g=r-p;o=true}else{if(g<=(-p)){g=0;o=true}}if(i>=l){i=l-m;n=true}else{if(i<=(-m)){i=0;n=true}}if(o){h.css("left",g+"px")}if(n){h.css("top",i+"px")}}})(jQuery,Fai.top._elemZone||(Fai.top._elemZone={}));(function(i,k,f){var j;k.initAlignLine=function(m){var l={showGap:2,inTopLine:false,inRightLine:false,inBottomLine:false,inLeftLine:false,initLevelLine:false,initVerticalLine:false,init:true,elem:null,helper:null,notElem:null,directionArr:["left","top","right","bottom","level","vertical"]};j=i.extend({},l,m);if(j.helper==null||j.elem==null){throw new Error("alignLine 参数错误")}e(j)};k.refreshAlignLine=function(){if(typeof j=="undefined"||j==null){throw new Error("alignLine 未初始化")}e(j)};k.resetAlignLine=function(){j=null;Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom, #absAlignLeft, #absAlignLevel, #absAlignVertical").hide()};k.getModuleAutoHeight=function(l){return d(l)};k.addModuleResizeHandle=function(l){a(l)};function e(v){var s=v.elem,q=v.helper,m=v.notElem,n=v.directionArr,p=s.attr("id"),x=q[0].getBoundingClientRect(),o,r,w=v.callback||i.noop;var t=i(window),l=t.height(),u=t.width();o=Fai.top.$(".form, #g_main").filter(function(){var A=i(this),C=A.offset(),D=this.getBoundingClientRect(),B=D.height,F=D.width,G=C.top,E=G+B,z=C.left,y=F+z;if(this===q){return false}if(G>=l||E<=0||z>=u||y<=0){return false}if(i.inArray(i(this).attr("id"),m)>-1){return false}return true});x.level=(x.bottom+x.top)/2;x.vertical=(x.right+x.left)/2;Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom, #absAlignLeft, #absAlignLevel, #absAlignVertical").hide();if(j.init){j.compareData=h(o)}g(x,j.compareData,q,s,n);j.init=false}function g(x,r,m,E,p){Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom, #absAlignLeft, #absAlignLevelLine, #absAlignVerticalLine").css("opacity",1);var I=0,w=0,n=0,D=0,B=0,l=0,y=0,o=0,v=0,G=0,t=0,F=0,s=[x.left,x.right],H=[x.top,x.bottom],A=[x.left,x.right],u=[x.top,x.bottom];obtainLevel=[x.left,x.right],obtainVertical=[x.top,x.bottom];for(var C in r){var z=r[C];I=x.top-z.top;w=x.right-z.right;n=x.bottom-z.bottom;D=x.left-z.left;B=x.level-z.level;l=x.vertical-z.vertical;if(i.inArray("top",p)!=-1&&Math.abs(I)<j.showGap){y=z.top;s.push(z.left,z.right);j.inTopLine=true}if(i.inArray("right",p)!=-1&&Math.abs(w)<j.showGap){o=z.right;H.push(z.top,z.bottom);j.inRightLine=true}if(i.inArray("bottom",p)!=-1&&Math.abs(n)<j.showGap){v=z.bottom;A.push(z.left,z.right);j.inBottomLine=true}if(i.inArray("left",p)!=-1&&Math.abs(D)<j.showGap){G=z.left;u.push(z.top,z.bottom);j.inLeftLine=true}if(i.inArray("level",p)!=-1&&Math.abs(B)<j.showGap){t=z.level;obtainLevel.push(z.left,z.right);j.initLevelLine=true}if(i.inArray("vertical",p)!=-1&&Math.abs(l)<j.showGap){F=z.vertical;obtainVertical.push(z.top,z.bottom);j.initVerticalLine=true}}var q=false;if(E.hasClass("formStyle81")||E.hasClass("formStyle79")){q=true}if(j.inTopLine){c("top",s);b("Top",y);j.inTopLine=false}if(j.inRightLine){c("right",H);b("Right",o);j.inRightLine=false}if(j.inBottomLine){c("bottom",A);b("Bottom",v);j.inBottomLine=false}if(j.inLeftLine){c("left",u);b("Left",G);j.inLeftLine=false}if(j.initLevelLine){c("level",obtainLevel);b("Level",t);j.initLevelLine=false}if(j.initVerticalLine){c("vertical",obtainVertical);b("Vertical",F);j.initVerticalLine=false}}function h(n){var l={},m=Fai.top.$(window).height();n.each(function(){var q=i(this),o=q.attr("id"),p;if(o){p=q[0].getBoundingClientRect();p.level=(p.bottom+p.top)/2;p.vertical=(p.right+p.left)/2;l[o]=p;if(p.top>=m||p.bottom<=0){return true}}});return l}function c(n,o){var l=Math.min.apply(null,o),m=Math.max.apply(null,o);switch(n){case"top":Fai.top.$("#absAlignTop").css({left:(l-15)+"px",width:(m-l+30)+"px"});break;case"right":Fai.top.$("#absAlignRight").css({top:(l-15)+"px",height:(m-l+30)+"px"});break;case"bottom":Fai.top.$("#absAlignBottom").css({left:(l-15)+"px",width:(m-l+30)+"px"});break;case"left":Fai.top.$("#absAlignLeft").css({top:(l-15)+"px",height:(m-l+30)+"px"});break;case"level":Fai.top.$("#absAlignLevel").css({left:(l-15)+"px",width:(m-l+30)+"px"});break;case"vertical":Fai.top.$("#absAlignVertical").css({top:(l-15)+"px",height:(m-l+30)+"px"});break;default:}}function b(n,o){var l=Fai.top.$("body");if(l.find(".absAlign"+n).length<1){var m="<div id='absAlign"+n+"' class='absAlign"+n+"' ";switch(n){case"Top":case"Bottom":case"level":m+="style='top:"+o+"px;' ";break;case"Left":case"Right":case"vertical":m+="style='right:"+o+"px;' ";break;default:}m+="></div>";l.append(m)}else{switch(n){case"Top":l.find(".absAlign"+n).css({top:o+"px",display:"block"});break;case"Bottom":l.find(".absAlign"+n).css({top:(o-1)+"px",display:"block"});break;case"Left":l.find(".absAlign"+n).css({left:o+"px",display:"block"});break;case"Right":l.find(".absAlign"+n).css({left:(o-1)+"px",display:"block"});break;case"Level":l.find(".absAlign"+n).css({top:o+"px",display:"block"});break;case"Vertical":l.find(".absAlign"+n).css({left:o+"px",display:"block"});break;default:}}}function d(p){var q=p.find(".J_packContent").children(".form"),o=200,n=p.find(".J_packFormBanner"),m,l,r;for(m=0;m<q.length;m++){l=q.eq(m);r=l.position().top+l.outerHeight(true);if(r>o){o=r}}if(n.length>0&&n.is(":visible")){o+=n.height()}return o}function a(p){var n=Fai.top.$("#module"+p),l=n.height(),o=d(n),m=true;if(l>=o){return}if(n.children(".J_resizableTip").length>0){return}if(Site.getModuleStatus(p)!=1){m=false}if(m){n.append("<a href='javascript:;' class='J_resizableTip ui-resizable-cancelTip fk-resizable-cancelTip ui-resizable-cancelTip2 fk-resizable-cancelTip2' _faiscoTip='还原模块高度' onclick='Site.dockModuleAutoHeight("+p+");Site.changeParentModuleHeightToAuto("+p+");return false;'></a>")}else{n.append("<a href='javascript:;' class='J_resizableTip ui-resizable-cancelTip fk-resizable-cancelTip ui-resizable-cancelTip2 fk-resizable-cancelTip2' parentid='module"+p+"' _faiscoTip='还原模块默认高度' onclick='Site.absModuleAutoHeight("+p+");return false;'></a>")}}})(jQuery,Fai.top._elemZone||(Fai.top._elemZone={}));(function(b,c){c.dragAllZoneCell=function(){b(".elemZoneCell").each(function(d,e){a(b(e))})};c.dragOneZoneCell=function(e){var d=e.find(".elemZoneCell");if(d.length>0){a(d)}};c.dragZoneOneCell=function(d){if(d.length>0){a(d)}};function a(d){d.draggable("destroy").draggable({containment:"parent",cursor:"move",axis:"x,y",scroll:false,distance:3,tolerance:2,smartguides:".form, .elemZoneCell",cancel:".elmeZoneCellNoDrag",start:function(){},stop:function(){}})}})($,Fai.top._elemZone||(Fai.top._elemZone={}));(function(b,c){c.resizeAllZoneCell=function(){b(".elemZone").find(".elemZoneCellResize").each(function(d,e){a(b(e))})};c.resizeOneZoneCell=function(e){var d=e.find(".elemZoneCellResize");if(d.length>0){a(d)}};c.resizeZoneOneCell=function(d){if(d.length>0){a(d)}};function a(d){var e;d.resizable("destroy");d.resizable({helper:"ui-resizable-helper",handles:"n, e, s, w, se, sw, ne, nw",autoHide:true,smartguides:".form, .elemZoneCell",create:function(f,g){Site.addResizableExtHandles(b(this));Site.refreshResizableHandles(b(this));b(this).off("mouseenter.zoneLine").on("mouseenter.zoneLine",".ui-resizable-handle",function(){b(this).addClass("f-handleHover").siblings(".ui-resizable-handle").addClass("f-handleHover")});b(this).off("mouseleave.zoneLine").on("mouseleave.zoneLine",".ui-resizable-handle",function(){b(this).removeClass("f-handleHover").siblings(".ui-resizable-handle").removeClass("f-handleHover")})},start:function(f,g){Site.disableEditLayer();Fai.top.$("body").disableSelection();e=b("#dockTip").show()},resize:function(g,h){var f=b(".ui-resizable-helper");e.html("高度:"+f.height()+"<br/>宽度:"+f.width()).css({left:g.pageX-28,top:g.pageY+18})},stop:function(f,g){Site.protectZoneElemResizable(b(this));Site.refreshResizableHandles(b(this));Site.enableEditLayer();Fai.top.$("body").enableSelection();e.hide();Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom,#absAlignLeft").hide();Site.styleChanged()}})}})($,Fai.top._elemZone||(Fai.top._elemZone={}));(function(k,c,l){c.selectToolAllZone=function(){k(".elemZone").each(function(){p(this)})};c.selectToolOneZone=function(A){var B=A.hasClass("elemZone")?A:A.find(".elemZone");if(B.length>0){B.each(function(){p(this)})}};c.selectToolModuleZone=function(){p(Fai.top.$("#fk-webBannerZone"));if(Fai.top._useBannerVersionTwo){p(Fai.top.$(".fk-inBannerListZone"))}else{p(Fai.top.$("#fk-webHeaderZone"))}p(Fai.top.$("#fk-webFooterZone"));d()};c.selectToolPackZone=function(){k(".J_packContent").each(function(){p(this)})};c.disableSelectable=function(A){var B=Fai.top.$(A);if(B.length<1){return}B.off(".mouseSelectable").off(".ctrlClickSelectable")};function d(){var A=Fai.top.$(document),B="#banner .J_bannerItem, #bannerGetHref";A.off("mousedown.selectable");if(!Fai.top._useBannerVersionTwo){if(k("#banner").length&&k("#banner").find(".J_bannerItem").length<1){B+=", #bannerGetHref, #banner "}A.on("mousedown.selectable",B,function(C){Fai.top.$("#fk-webBannerZone .fk-moduleZoneBg").trigger("mousedown.mouseSelectable",C)})}A.on("mousedown.selectable","#footer",function(C){if(k(C.target).is("a")||k(C.target).parent().is("a")){return}Fai.top.$("#fk-webFooterZone .fk-moduleZoneBg").trigger("mousedown.mouseSelectable",C)}).on("mousedown.selectable",".headerNav",function(C){if(k(C.target).is("a")||k(C.target).parent().is("a")){return}Fai.top.$("#fk-webHeaderZone .fk-moduleZoneBg").trigger("mousedown.mouseSelectable",C)})}function p(M){var I=Fai.top.$(M);if(I.length<1){return}var H=Fai.top.$(document);var E=I.attr("id").replace("elemZone","").replace("fk-packContent","");var D=I.attr("id").indexOf("Zone")>0?I:Fai.top.$("#module"+E);var B=new a();I.data("info",B);I.off(".mouseSelectable").on("mousedown.mouseSelectable",".J_zoneContentBg",function(T,R){if(Fai.top.Fai.isMozilla()){Fai.top.$("a.J_bannerItem").attr("ondragstart","return false")}var S=false;var Q=null;var P=I.hasClass("J_moduleZone")?Fai.top.$(document):I;P.on("mousemove.mouseSelectable",function(U){if(!S){T=R||T;G();Q=new t(T,I);B.init(I);B.zoneId=E;S=true}Q.change(U);B.refresh(Q.getConfig());m(B.all);h(B.mat,B.all);U.stopPropagation();U.preventDefault()});H.one("mouseup.mouseSelectable",function(U){if(Fai.top.Fai.isMozilla()){Fai.top.$("a.J_bannerItem").attr("ondragstart","")}var V=I.hasClass("J_moduleZone")?Fai.top.$(document):I;V.off("mousemove.mouseSelectable");if(!S){return}if(B.hasMat()){Site.logDog(100045,65);q(B.mat,B.all,I);L()}else{C()}Q.remove();Q=null;Site.checkSimpleTextHideTool();U.stopPropagation();U.preventDefault();return false});I.off("click.mouseSelectable").on("click.mouseSelectable",function(U){if(S){U.stopPropagation();U.preventDefault()}})}).off(".ctrlClickSelectable").on("click.ctrlClickSelectable",".form, .elemZoneCell",function(P){if(!J(P)){return}if(k(this).find(".floatImg_noImg_J").length>0){return}Site.logDog(100045,65);L();G();B.init(I);B.refresh(new t(P,I).remove().getConfig(),true);h(B.mat);q(B.mat,B.all,I);z(B.getElemInfo(k(this)),B.all)}).on("click.ctrlClickSelectable",".J_selectableMask",function(P){if(J(P)){B.refresh(new t(P,I).remove().getConfig(),true);h(B.mat);q(B.mat,B.all,I)}else{if(P.button==0){C()}}}).on("click.ctrlClickSelectable",".J_selectedArea",function(R){if(!J(R)){return}var Q=v(R,I),S=Q.left,P=Q.top;B.init(I);k.each(B.all,function(V,Y){var X=Y.left+Y.marginLeft,T=Y.right+Y.marginLeft,Z=Y.top+Y.marginTop,W=Y.bottom+Y.marginTop;if(S>X&&S<T&&P>Z&&P<W){var U=B.mat.indexOf(Y);if(U>-1){B.delMat(Y);q(B.mat,B.all,I);g(Y.$elem);if(B.mat.length<1){C()}}else{B.addMat(Y);q(B.mat,B.all,I);z(V,B.all)}}})});if(I.hasClass("J_moduleZone")){d()}var O;function K(){O=O?O.show():Fai.top.$("<div class='fk-selectableMask J_selectableMask' style='width:"+I.width()+"px;height:"+I.height()+"px;'>").appendTo(I)}function L(){Site.addModuleMask({id:E,realElem:D,callback:function(){Fai.top.$(".moduleMask-center").remove();var T=parseInt(I.css("border-left-width")),S=parseInt(I.css("border-right-width")),R=parseInt(I.css("border-top-width")),Y=parseInt(I.css("border-bottom-width"));var Q=Fai.top.$(".moduleMask-left");var X=Q.width()+T;Q.width(X);var V=Fai.top.$(".moduleMask-top");var P=V.width()-T-S;V.height(V.height()+R).width(P).css("left",X+"px");var U=Fai.top.$(".moduleMask-bottom");U.height(U.height()+Y).css("top",parseInt(U.css("top"))-Y+"px").width(P).css("left",X+"px");var W=Fai.top.$(".moduleMask-right");W.width(W.width()+S).css("left",X+P+"px")},extFn:[{name:"click",fn:C}]})}function F(){if(O){O.remove();O=null}Site.removeModuleMask()}function G(){N();H.off("mousewheel.selectwheel").on("mousewheel.selectwheel",function(P){setTimeout(function(){N()},200);P.preventDefault()}).off("keydown.selectwheel").on("keydown.selectwheel",function(P){if(P.keyCode==32||P.keyCode==9){P.preventDefault()}});K();I.off("contextmenu.selectable").on("contextmenu.selectable",function(P){P.stopPropagation()});I.removeClass("extformClass")}function C(){A();H.off(".selectwheel");F();I.off("contextmenu.selectable");I.addClass("extformClass");x(I);o(B.all);B.reset();c.resetAlignLine()}function N(){Site.disableEditLayer();Fai.top.$("body").disableSelection()}function A(){Site.enableEditLayer();Fai.top.$("body").enableSelection()}function J(P){return P.ctrlKey&&P.button==0}}function v(D,G){var E=G.offset(),A=E.left,F=E.top,C=D.clientY-F,B=D.clientX-A;return{top:C,left:B}}function h(C){var D=0,A=C.length,B;for(;D<A;D++){B=C[D];z(B)}}function m(B){var A;for(form in B){A=B[form];g(A.$elem)}}function o(D){var B=0,A=D.length,C;for(;B<A;B++){C=D[B];e(C)}}function s(D){var B=0,A=D.length,C;for(;B<A;B++){C=D[B];i(C);z(C)}}function z(A){var B=A.$elem,C=B.find(">.J_selectedLineWrap");if(C.length<1){C=i(A)}B.css({overflow:"visible"});C.show()}function g(A){var B=A.find(">.J_selectedLineWrap");if(B.length<1){return}A.removeCss("overflow");B.hide()}function e(A){var B=A.$elem,C=B.find(">.J_selectedLineWrap");if(C.length<1){return}B.removeCss("overflow");C.remove()}function i(C){e(C);var D=C.$elem,F=D.find(">.J_selectedLineWrap"),H=parseInt(D.css("border-top-width"))||0,B=parseInt(D.css("border-left-width"))||0,E,G;var A=1;G=C;E=[];E.push("<div class='fk-selectedLineWrap J_selectedLineWrap' style='width:"+G.outerWidth+"px;height:"+G.outerHeight+"px;left:"+(-A-B)+"px;top:"+(-A-H)+"px;'>");E.push("</div>");return Fai.top.$(E.join("")).appendTo(D)}function q(Q,K,L){x(L);if(Q.length<1){return}var F=L.data("info");var N=F.mat,H={},G=H.left=C("left",0)-1,M=H.top=C("top",0)-1,O=H.right=C("right",1)+1,B=H.bottom=C("bottom",1)+1,E=O-G,P=B-M,I,D;H.width=E;H.height=P;var J=1;G=H.left=G-J;M=H.top=M-J;H.right=O-J+2;H.bottom=B-J+2;D=parseInt(Math.random()*10000);I=[];I.push("<div id='selectedAreaWrap"+D+"' class='fk-selectedAreaWrap J_selectedAreaWrap'>");I.push("    <div class='f-selectedArea J_selectedArea' style='width:"+E+"px;height:"+P+"px;left:"+(G-1)+"px;top:"+(M-1)+"px;'></div>");I.push("</div>");var A=Fai.top.$(I.join("")).appendTo(L);A.find(".J_selectedArea").show();k.each(Q,function(S,R){R.$elem.addClass("J_onSelected")});w(Q,K,L,H);y(D,Q,K,L,H);n(L,H);function C(S,R){return[Math.min,Math.max][R].apply(null,k.map(N,function(V,T){var U={left:V.marginLeft,right:V.marginLeft,top:V.marginTop,bottom:V.marginTop};return V[S]+U[S]}))}}function x(B){var A=B.find(".J_selectedAreaWrap");B.find(".J_onSelected").removeClass("J_onSelected");A.off().remove();f(B);Fai.top.$(document).off("keydown.areaDrag")}function u(A,C,B){B.eachMat(function(E,D){D.left=D.left+A;D.top=D.top+C})}function y(B,N,G,J,D){var A=Fai.top.$("#selectedAreaWrap"+B);if(A.length<1){return}var E=A.find(".J_selectedArea"),M=J.find(".J_onSelected"),K=J.find(".J_selectedTool");var C=J.data("info");var F,L,H,I;E.draggable("destroy").draggable({tolerance:2,smartguides:".form, .elemZoneCell",scroll:false,start:function(P,Q){var O=Q.position;F=O.left;L=O.top;K.hide();C.styleChanged()},drag:function(Q,T){var O=T.position,S=O.left,R=O.top,P=S-F,U=R-L;u(P,U,C);F=S;L=R},stop:function(O,P){D.left=P.position.left;D.top=P.position.top;D.right=D.left+D.width+2;D.bottom=D.top+D.height+2;n(J,D);b(D,J);Site.logDog(200084,2);Fai.top._moduleMoved++}}).resizable("destroy").resizable({autoHide:false,handles:"n, e, s, w, se, sw, ne, nw",aspectRatio:false,create:function(){var W=k(this);var U=W.children(".ui-resizable-sw").attr("_faiscotip","同时按住Shift，可实现等比例缩放"),S=W.children(".ui-resizable-se").attr("_faiscotip","同时按住Shift，可实现等比例缩放"),R=W.children(".ui-resizable-nw").attr("_faiscotip","同时按住Shift，可实现等比例缩放"),P=W.children(".ui-resizable-ne").attr("_faiscotip","同时按住Shift，可实现等比例缩放"),T=W.children(".ui-resizable-s"),Q=W.children(".ui-resizable-w"),V=W.children(".ui-resizable-n"),O=W.children(".ui-resizable-e");Site.addResizableExtHandles(W)},start:function(O,P){H=P.size.width;I=P.size.height;F=P.position.left;L=P.position.top;K.hide();C.eachMat(function(R,Q){if(Q.style==82){return}Q.origWidth=Q.width;Q.origHeight=Q.height},function(R,Q){if(Q.style==82){return}if(Q.style==79){var S=Q.$elem;S.find(".formMiddleContent").css("overflow","visible");S.find(".formMiddleContent").css("overflow-y","visible");var U=S[0].id.slice(6),T=k("#hoverEftDialog"+U);if(T.length>0&&!!Site.removeHoverEftDialog){Site.removeHoverEftDialog(U)}}else{if(Q.style==81){}}});C.styleChanged()},resize:function(P,X){D.width=X.size.width;D.height=X.size.height;D.top=X.position.top;D.left=X.position.left;D.bottom=D.top+D.height;D.right=D.left+D.width;var U=1;var Y=D.width-U*2;var R=D.height-U*2;var V=H-U*2;var aa=I-U*2;var S=Y/V;var W=R/aa;var Q=D.left+3;var O=D.top+3;var Z=D.left-F;var T=D.top-L;C.eachMat(function(ac,ab){if(ab.style==82){return}if(ab.$elem.hasClass("elemZoneCell")&&!ab.$elem.hasClass("elemZoneCellResize")){return}ab.width=ab.outerWidth*(Y/V)-ab.borderLeft-ab.borderRight;ab.height=ab.outerHeight*(R/aa)-ab.borderTop-ab.borderBottom;ab.left=(ab.left+D.left-F-Q+ab.marginLeft)*(Y/V)+Q-ab.marginLeft;ab.top=(ab.top+D.top-L-O+ab.marginTop)*(R/aa)+O-ab.marginTop},function(ac,ab){if(ab.style==82){return}var ad=ab.$elem;if(ab.style==79){(function(){var aj=ab.$elem;var ag=aj.find(".formBanner"),ah=ag.is(":visible")?ag.height():0;aj.find(".J_defImage, .floatImgWrap"+(aj.find(".J_fonticon").length>0?"":", .forMargin")).css({width:ab.width,height:ab.height-ah});var ai=ab.width-1;var af=ab.height;var ae=ai>af?af:ai;if(aj.find(".float_in_img").attr("class").indexOf("mr")!=-1&&ai<260){ae=ai/2}aj.find(".float_in_img").css({"font-size":ae,"line-height":af+"px"});aj.find(".J_hoverImage").css({"font-size":ae,"line-height":af+"px"})})()}else{if(ab.style==81){(function(){var aj=ab.$elem;var al=aj.find(".floatBtn");var ae=aj.find(".formBanner"),ah=ae.is(":visible")?ae.height():0;var ag=2*parseInt(al.css("borderLeftWidth"))||0,af=al.height();var ak=["top","right","bottom","left"];Site.absAlignLine.resize.init(ad,aj,P,ak);var ai=aj.attr("id").replace("module","");Site.setModuleStyleCssList(ai,[{cls:".floatBtn",key:"width",value:(ab.width-ag)+"px"},{cls:".floatBtn",key:"height",value:(ab.height-ag-ah)+"px"},{cls:".floatBtn",key:"line-height",value:af+"px"},])})()}else{if(ab.style==86){(function(){Site.refreshSimpleEditor(ad,ad);Fai.top.$(".J_fkEditor_tool").css("display","none")})()}else{(function(){ad.find(".formMiddle").find(".formMiddleCenter").css("vertical-align","top");if(ad.hasClass("formStyle35")||ad.hasClass("formStyle29")){ad.attr("_mousein",1)}if(ad.hasClass("formStyle97")){var ae=ad.attr("id").substring(6);k(".styleMall"+ae).hide()}})()}}}});H=X.size.width;I=X.size.height;F=X.position.left;L=X.position.top},stop:function(O,P){D.width=P.size.width;D.height=P.size.height;D.top=P.position.top;D.left=P.position.left;D.bottom=D.top+D.height;D.right=D.left+D.width;C.eachMat(function(S,R){if(R.style==82){return}if(R.$elem.hasClass("elemZoneCell")&&!R.$elem.hasClass("elemZoneCellResize")){return}var U=R.style;var T=R.$elem;var W=T[0];var V=R.$elem;if(U==79){(function(){var aa=R.$elem;var Y=aa.attr("id").replace("module","");var ad=Site.checkNestModule(V);Fai.top._moduleMoved++;Site.moduleSizeChange("module"+Y);aa.trigger("Fai_onModuleSizeChange");if(aa.find("map").length){Site.refreshFloatImgHotArea(modules)}if(ad.inPack){Site.setModuleAttrDataChange(ad.parentId)}Site.protectZoneElemResizable(aa);setTimeout(function(){Site.triggerGobalEvent("changeParentModuleHeightToAuto",{id:Y})},0);var X=aa[0].id.slice(6);refreshHoverImgEft(X,aa.data("imgHoverEft"));if(Site.getModuleStatus(X)==3){Site.refreshAbsFloatForm(aa)}var af=8;var ab=R.width;var ac=R.height;var Z=(parseInt(ab)-af)/2-2;var ae=(parseInt(ac)-af)/2-2;aa.children(".ui-resizable-s").children(".imgResizeLine").css({width:Z+"px"});aa.children(".ui-resizable-n").children(".imgResizeLine").css({width:Z+"px"});aa.children(".ui-resizable-e").children(".imgResizeLine").css({height:ae+"px"});aa.children(".ui-resizable-w").children(".imgResizeLine").css({height:ae+"px"})})()}else{if(U==81){(function(){var aa=V;var ad=aa.find(".floatBtn");var ab=Site.checkNestModule(V);k(".draggableBtn").css({opacity:"1"});Site.enableEditLayer();aa.children(".ui-resizable-handle").show();var ac=k("#dockTip");ac.hide();var Z=aa.attr("id").replace("module","");var Y=ad.height();Site.setModuleStyleCssList(Z,[{cls:".floatBtn",key:"line-height",value:Y+"px"},]);Site.getModuleAttrPattern(Z).changed=true;var X=Site.getModuleAttrPattern(Z).floatBtn;X.s=X.s||{};X.s.t=1;X.s.w=parseInt(ad.width());X.s.h=parseInt(ad.height());Fai.top._moduleMoved++;Site.setFlBtnModuleWidth(aa);Site.styleChanged();Site.moduleSizeChange("module"+Z);aa.trigger("Fai_onModuleSizeChange");Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom,#absAlignLeft").hide();if(ab.inPack){Site.setModuleAttrDataChange(ab.parentId)}Site.protectZoneElemResizable(aa);setTimeout(function(){Site.triggerGobalEvent("changeParentModuleHeightToAuto",{id:Z})},0)})()}else{if(U==86){if(T.find(".J_resizableTip").length>0){T.find(".J_resizableTip").show()}else{T.append("<a href='javascript:;' class='J_resizableTip moduleAutoHeight ui-resizable-cancelTip fk-resizable-cancelTip' style='z-index:1000;' parentid='"+T.attr("id")+"' _faiscoTip='还原模块默认高度' onclick='Site.absModuleAutoHeight("+T.attr("id").replace("module","")+");return false;'></a>")}if(T.find(".fk-editor-vertical-rl").length>0){T.find(".fk-editor").attr("_autowidth",0)}Site.createSimpleTextAutoWidthBtn(T);Q.apply(R.$elem[0])}else{Q.apply(R.$elem[0])}}}R.$elem.attr("_autoheight",0);Site.refreshModuleHeight(R.id);function Q(Y,ae){var aa=k(this).attr("_moduleid");var af=Site.checkNestModule(k(this));Site.protectZoneElemResizable(k(this));if(k(this).hasClass("formStyle35")||k(this).hasClass("formStyle29")){k(this).attr("_mousein",1)}if(!k(this).hasClass("elemZoneCell")){var Z=k(this).attr("id").replace("module","");if(k(this).children(".ui-resizable-cancelTip").length<1){var ad=k(this).find(".ui-resizable-se").css("z-index");var ac="";if(k(this).hasClass("formStyle29")||k(this).hasClass("formStyle35")||k(this).hasClass("formStyle80")){ac+=" ui-resizable-cancelTip2 fk-resizable-cancelTip2"}}Site.getModuleAttrPattern(Z).changed=true;Site.setModuleAttrDataChange(af.parentId);var ab=k(this).attr("_side");if(ab!=2){Site.refreshAbsFloatForm(k(this))}Site.refreshSideBtn(k(this));Site.moduleSizeChange("module"+Z);if(k(this).hasClass("formStyle5")||k(this).hasClass("formStyle77")){Site.refreshModulePhotoSwitch(Z)}Site.triggerGobalEvent("resizableModuleChange",Z);Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom,#absAlignLeft").hide();if(k(this).hasClass("formStyle83")){Site.initPhotoCard(Z)}if(k(this).hasClass("formStyle85")){Site.initPhotoNewCard(Z)}if(k(this).hasClass("formStyle98")){if(k(this).width()<=400){k(this).css("height",R.origHeight+"px");k(this).css("width",R.origWidth+"px");R.height=R.origHeight;R.width=R.origWidth}else{if(R.origWidth!=k(this).width()){Site.initPhotoMoreCard(Z,R.origWidth)}else{Site.initPhotoMoreCard(Z)}}}if(k(this).hasClass("formStyle97")){aa=k(this).attr("_moduleid");k(this).find(".mallHead").click();k(".styleMall"+aa).stop(true,true).show()}Site.triggerGobalEvent("changeParentModuleHeightToAuto",{id:aa})}k(this).trigger("Fai_onModuleSizeChange");X({module:k(this),parentId:af.parentId});if(k(this).parent().hasClass("J_packContent")){Site.logDog(100092,0);Site.logDog(100092,6);Site.logDog(100045,64)}else{if(k(this).parent().hasClass("J_moduleZone")){Site.logDog(100092,0);Site.logDog(100092,7)}}Site.styleChanged();function X(aj){var ah=aj.module,ap=ah.width(),am=ah.height(),ak=ah.position(),ag=ak.left,ai=ak.top,aq=Fai.top.$("#module"+aj.parentId),ar=aq.width(),al=aq.height(),ao=false,an=false;if(ag>=ar){ag=ar-ap;ao=true}else{if(ag<=(-ap)){ag=0;ao=true}}if(ai>=al){ai=al-am;an=true}else{if(ai<=(-am)){ai=0;an=true}}if(ao){ah.css("left",ag+"px")}if(an){ah.css("top",ai+"px")}}}},function(R,Q){if(Q.$elem.hasClass("elemZoneCell")){Site.refreshResizableHandles(Q.$elem)}});q(N,G,J);b(D,J);k(this).find(".ui-resizable-handle").show()}}).off(".rh").on("hover.rh",function(){k(this).find(".ui-resizable-handle").show()});Fai.top.$(document).off("keydown.areaDrag").on("keydown.areaDrag",function(R){var Q={37:1,38:1,39:1,40:1};if(!Q[R.which]){return}R.preventDefault();var O=E.position(),T=O.left,S=O.top,P=0,V=0;switch(R.which){case 37:P=-1;break;case 38:V=-1;break;case 39:P=1;break;case 40:V=1;break;default:break}D.left=D.left+P;D.right=D.right+P;D.top=D.top+V;D.bottom=D.bottom+V;E.css({left:T+P,top:S+V});u(P,V,C);Q=k.map(C.mat,function(X,W){return"#"+X.elemZoneId}).join(",");Q=Fai.top.$(Q);var U=k.map(C.mat,function(X,W){return X.elemZoneId});c.initAlignLine({elem:Q,helper:Q,notElem:U});c.refreshAlignLine({elem:Q,helper:Q});n(J,D);b(D,J);C.styleChanged();Site.logDog(200084,3);Fai.top._moduleMoved++})}function w(J,F,H,B){var C=H.find(".J_selectedTool"),E,I;if(C.length<1){I=D();E=G(I);var A=H.find(".J_selectedAreaWrap");C=Fai.top.$(E).appendTo(A);j(J,F,H,B);b(B,H)}return C;function D(){var K=[{toolType:"Align",toolList:[{toolFunc:"left",toolFuncName:"左对齐"},{toolFunc:"right",toolFuncName:"右对齐"},{toolFunc:"top",toolFuncName:"上对齐"},{toolFunc:"bottom",toolFuncName:"下对齐"},{toolFunc:"level",toolFuncName:"上下居中"},{toolFunc:"vertical",toolFuncName:"左右居中"}]},{toolType:"Spread",toolList:[{toolFunc:"vertical",toolFuncName:"垂直分布"},{toolFunc:"level",toolFuncName:"水平分布"}]}];return K}function G(P){var N=[];N.push("<div class='fk-selectedTool J_selectedTool'>");for(var M=0,L;M<P.length;M++){L=P[M];N.push("<div class='f-toolType f-tool"+L.toolType+" J_toolType'>");N.push("<div class='f-icon f-toolType-icon J_toolTypeIcon J_toolTypeIcon"+L.toolType+"'></div>");N.push("<div class='f-toolType-wrap J_toolTypeWrap'>");N.push("<div class='f-wrap-cover'></div>");for(var K=0,O;K<L.toolList.length;K++){O=L.toolList[K];N.push("<div class='f-wrap-item' onclick='Fai.top._elemZone."+O.toolFunc+L.toolType+"();'>");N.push("<div class='f-icon f-icon-"+O.toolFunc+"'></div>");N.push("<div class='f-text'>"+O.toolFuncName+"</div>");N.push("</div>")}N.push("</div>");N.push("</div>")}N.push("</div>");return N.join("")}}function j(L,G,H,B){var J=H.find(".J_selectedTool");if(J.length<1){return}var A=H.data("info");J.find(".J_toolType").off("mouseenter.toggle, mouseleave.toggle").on("mouseenter.toggle, mouseleave.toggle",function(){var N=k(this),P=N.find(".J_toolTypeIcon"),O=N.find(".J_toolTypeWrap"),M=L.length>1&&O.css("display")=="none";if(M){if(P.hasClass("J_toolTypeIconSpread")&&L.length<3){return}O.show();if(k("#bannerV2").find(O).length==0){O.css({left:(N.offset().left)+"px",top:(N.offset().top+36)+"px"})}P.addClass("f-toolTypeIcon-show")}else{O.hide();P.removeClass("f-toolTypeIcon-show")}});J.find(".J_toolTypeWrap").off("click.toggle").on("click.toggle",function(M){J.find(".J_toolTypeWrap").hide();J.find(".J_toolTypeIcon").removeClass("f-toolTypeIcon-show")});J.find(".J_toolTypeIcon").off("click.tip").on("click.tip",function(M){var N=k(this);if(N.hasClass("J_toolTypeIconAlign")){if(L.length<2){Fai.ing("圈选两个以上模块，才可以使用对齐功能",true)}}if(N.hasClass("J_toolTypeIconSpread")){if(L.length<3){Fai.ing("圈选三个以上模块，才可以使用分布功能",true)}}});(function(){var N=J.find(".J_toolTypeIconAlign");if(L.length<2){N.css({cursor:"not-allowed"})}else{N.removeCss("cursor")}var M=J.find(".J_toolTypeIconSpread");if(L.length<3){M.css({cursor:"not-allowed"})}else{M.removeCss("cursor")}})();c.leftAlign=function(){A.eachMat(function(M,N){N.left=B.left+2-N.marginLeft});A.styleChanged();q(L,G,H)};c.rightAlign=function(){A.eachMat(function(M,N){N.left=B.right-2-N.outerWidth-N.marginLeft});A.styleChanged();q(L,G,H)};c.topAlign=function(){A.eachMat(function(M,N){N.top=B.top+2-N.marginTop});A.styleChanged();q(L,G,H)};c.bottomAlign=function(){A.eachMat(function(M,N){N.top=B.bottom-2-N.outerHeight-N.marginTop});A.styleChanged();q(L,G,H)};c.verticalAlign=function(){var M=(B.right+B.left)/2;A.eachMat(function(O,P){var N=(M-P.outerWidth/2)-P.marginLeft;P.left=N});A.styleChanged();q(L,G,H)};c.levelAlign=function(){var M=(B.bottom+B.top)/2;A.eachMat(function(O,P){var N=(M-P.outerHeight/2)-P.marginTop;P.top=N});A.styleChanged();q(L,G,H)};c.levelSpread=function(){K(0);A.styleChanged()};c.verticalSpread=function(){K(1);A.styleChanged()};function K(P){var N=C(A.mat,P);var O=E(N,F,P);var M=O/(N.length-1);E(N,D,P,M);q(L,G,H)}function E(N,M){var Q,O,P=[].slice.call(arguments,2);k.each(N,function(S,R){if(S==0){Q=R;return}O=M.apply(R,[Q,R,S,O].concat(P));Q=R});return O}function D(O,Y,M,N,Q,R){var X=["left","top"][Q],W=["right","bottom"][Q],V=["right","bottom"][Q],U=["outerWidth","outerHeight"][Q],T=["marginLeft","marginTop"][Q],P,S={};Y[X]=(O[W]+O[T])+R-Y[T];P=Y[X];S[X]=P+"px";Y[V]=P+Y[U];Y.$elem.css(S)}function F(P,U,M,O,Q){var T=["left","top"][Q],S=["marginLeft","marginTop"][Q],R=["right","bottom"][Q];var N=(U[T]+U[S])-(P[R]+P[S]);return(O||0)+N}function C(R,S){var N=R.length,Q;var P;var M=["left","top"][S];var O=["marginLeft","marginTop"][S];while(N>0){for(Q=0;Q<N-1;Q++){if(R[Q][M]+R[Q][O]>R[Q+1][M]+R[Q+1][O]){P=R[Q];R[Q]=R[Q+1];R[Q+1]=P}}N--}return R}function I(N){var M=[];k.each(N,function(O,P){var Q=P;M.push(Q)});return M}}function b(B,G){var H=Fai.top.$(".J_selectedTool");var E=Fai.top.$(".J_selectedArea");if(H.length<1||E.length<1){return}var D=10,F=H.outerHeight(),A=B.left,C=B.top-D-F;A=A<0?0:A;if(C<0){C=B.bottom+D;C=C+F>G.find(".elemZone").height()?0:C}H.css({left:A+"px",top:C+"px"}).show()}function r(A){var B=A.find(".J_selectedTool");if(B.length<1){return}B.hide()}function f(A){var B=A.find(".J_selectedTool");if(B.length<1){return}B.off().remove()}function n(E,A){var D=E.data("info");var C=E.width();var F=E.height();var B=Fai.top.$(".J_selectedArea");D.eachMat(function(I,H){var G=H.left<0&&(H.right+H.marginLeft*2)<10;var M=(C-H.left)<10;if(G||M){var J=0;if(G){J=-A.left}else{if(M){J=C-A.right}}var N=0;A.left=A.left+J;A.top=A.top+N;A.right=A.left+A.width;A.bottom=A.top+A.height;B.css(A);var L=A.left,K=A.top;u(J,N,D);b(A,E);return false}});D.eachMat(function(H,G){var J=G.top<0&&(G.bottom+G.marginTop*2)<10;var K=(F-G.top)<10;if(J||K){var I=0;var L=0;if(J){L=-A.top}else{if(K){L=F-A.bottom}}A.left=A.left+I;A.top=A.top+L;A.right=A.left+A.width;A.bottom=A.top+A.height;B.css(A);u(I,L,D);b(A,E);return false}})}function a(){this.all=[];this.mat=[];this.hasInit=false}a.prototype.reset=function(){var A=this;A.all.splice(0,A.all.length);A.mat.splice(0,A.mat.length);A.hasInit=false};a.prototype.refresh=function(J,G){var M=this,E,D,B;var K=J.left,H=J.right,F=J.top,C=J.bottom;for(E=0,D=M.all.length;E<D;E++){var B=M.all[E],A=B.left,N=B.right,L=B.top,I=B.bottom;if(B.style==81){A+=B.marginLeft;N+=B.marginLeft;L+=B.marginTop;I+=B.marginTop}if(N<K||L>C||A>H||I<F){if(!G){M.delMat(B)}}else{M.addMat(B)}}};a.prototype.delMat=function(A){var B=this;while(k.inArray(A,B.mat)>-1){B.mat.splice(k.inArray(A,B.mat),1)}};a.prototype.addMat=function(A){var B=this;if(k.inArray(A,B.mat)>-1){return}B.mat.push(A)};a.prototype.hasMat=function(){var A=this;return A.mat.length>0};a.prototype.init=function(B){var A=this;if(!B){return}if(A.hasInit){return}B.find(">.form, >.elemZoneCell").each(function(){var M=k(this),R=M.attr("id"),G=M.attr("_moduleid"),W=M.position(),I=W.left,O=W.top,S=M.width(),Q=M.height(),C=M.outerWidth(),D=M.outerHeight(),E=+M.css("border-left-width").replace("px",""),H=+M.css("border-right-width").replace("px",""),P=+M.css("border-top-width").replace("px",""),L=+M.css("border-bottom-width").replace("px",""),T=+M.css("margin-left").replace("px",""),J=+M.css("margin-right").replace("px",""),F=+M.css("margin-top").replace("px",""),K=+M.css("margin-bottom").replace("px",""),V=I+C,N=O+D,U=M.attr("_modulestyle");A.all.push({left:I,top:O,width:S,height:Q,right:V,bottom:N,size:{width:S,height:Q},outerWidth:C,outerHeight:D,outerSize:{width:C,height:D},borderLeft:E,borderRight:H,borderTop:P,borderBottom:L,marginLeft:T,marginRight:J,marginTop:F,marginBottom:K,position:{left:I,top:O},config:k.extend({},this.size,this.position,{right:this.right,bottom:this.bottom}),style:U,"$elem":M,id:G||"elemCell",elemZoneId:R})});A.hasInit=true};a.prototype.getElemInfo=function(C){var B=this,D,A;for(D=0,A=B.all.length;D<A;D++){if(B.all[D].$elem.is(C)){return B.all[D]}}return null};a.prototype.eachMat=function(A,D){var C=this,G,B,F;for(G=0,B=C.mat.length;G<B;G++){F=C.mat[G];var E=A.apply(F.$elem[0],[G,F]);F.outerWidth=F.width+F.borderLeft+F.borderRight;F.outerHeight=F.height+F.borderTop+F.borderBottom;F.bottom=F.top+F.outerHeight;F.right=F.left+F.outerWidth;F.size.width=F.width;F.size.height=F.height;F.position.left=F.left;F.position.top=F.top;F.outerSize.width=F.outerWidth;F.outerSize.height=F.outerHeight;k.extend(F.config,F.size,F.position,{right:F.right,bottom:F.bottom});F.$elem.css(F.size).css(F.position).find(".J_selectedLineWrap").css(F.outerSize);if(typeof D=="function"){D.apply(F.$elem[0],[G,F])}}};a.prototype.styleChanged=function(A){var B=this;Site.getModuleAttrPattern(B.zoneId).changed=true;Site.getModuleAttrData(B.zoneId).changed=true;k.each(B.mat,function(D,C){var E=C.id;Site.getModuleAttrPattern(E).changed=true;Site.getModuleAttrData(E).changed=true});Site.styleChanged()};function t(C,B){var A=this;A.width=0;A.height=0;A.$wrap=Fai.top.$(B);A.fClass="fk-mouseSelectableTool";A.jClass="J_mouseSelectableTool";A._getMousePosition(C);A._update();A._create();return A}t.prototype._getMousePosition=function(E){var B=this;var F=B.$wrap.offset(),A=F.left,G=F.top,D=E.clientY-G,C=E.clientX-A;B.left=C;B.top=D;return B};t.prototype._update=function(){var A=this;A.right=A.left+A.width;A.bottom=A.top+A.height;A.size={width:A.width,height:A.height};A.position={left:A.left,top:A.top};A.config=k.extend({},A.size,A.position,{right:A.right,bottom:A.bottom});return A};t.prototype._create=function(){var A=this;A.oriLeft=A.left;A.oriTop=A.top;A.oriPosition={left:A.oriLeft,top:A.oriTop};Fai.top.$("."+A.jClass).remove();A.$elem=Fai.top.$("<div class='"+A.fClass+" "+A.jClass+"'></div>").appendTo(A.$wrap).css(A.oriPosition);return A};t.prototype.change=function(B){var A=this;A._getMousePosition(B);A.width=Math.abs(A.left-A.oriLeft);A.height=Math.abs(A.top-A.oriTop);if(A.left>A.oriLeft){A.left=A.left-A.width}if(A.top>A.oriTop){A.top=A.top-A.height}A._update();A.$elem.css(A.size).css(A.position);return A};t.prototype.remove=function(){var A=this;A.$elem.remove();A.$elem=null;A.$wrap=null;return A};t.prototype.getConfig=function(){var A=this;return k.extend({},A.config)}})(jQuery,Fai.top._elemZone||(Fai.top._elemZone={}));(function(d,c,a,b){function f(){b.sortAllZoneModule();b.resizeAllZoneModule();b.dragAllZoneCell();b.resizeAllZoneCell();b.selectToolAllZone();b.initAllPackAddModuleBtn()}function e(g){b.sortOneZoneModule(g);b.resizeOneZoneModule(g);b.dragOneZoneCell(g);b.resizeOneZoneCell(g);b.selectToolOneZone(g);b.initAddModuleBtn(g)}b.init=function(){f()};b.initOne=function(g){e()}})($,Fai,Site,Fai.top._elemZone||(Fai.top._elemZone={}));