Site.addModuleContextMenu=function(d){if($("#module"+d.id).attr("_inSubNavPack")==1){return}if(!Fai.top._contextMenu){return}if(!Fai.top._designAuth){return}if(!("contextMenu" in $)){return}if(Object.prototype.toString.call(d).toLowerCase()!="[object object]"){throw new Error("Site.addModuleContextMenu 参数错误");return}var r;$.contextMenu({selector:"#module"+d.id,className:"fk-moduleContextMenu fk-moduleContextMenu"+d.id,classNames:{icon:"f-icon"},build:function(aa,ak){var W={},P={},O={},M={},L={},K={},J={},E=[J,P,M,O,L,K],I=d.id,C=Fai.top.$("#module"+I),am=w(C),ac=d.moduleOperateList||{},G=d.moduleStateList||{},X=d.moduleDirectionList||{},H=d.moduleOtherList||{},U=G.length,aj=ac.length,T=X.length,ah=H.length,S=false,V=false,R=false,F=false,Z=false,B=false,N=Site.checkModuleInZone(C),Q=0,al,A,ab,af,ad,ai;if(C.data("lockedit")!="lock"){for(ai=0;ai<aj;ai++){al=ac[ai];A=al.iconClass||"oper"+ai;ab=al.text;af=al.statusScript||1;ad=al.evalScript;if(Fai.fkEval(af)!=-1){S=true;V=true;P[A]={};P[A]["name"]=ab;P[A]["usehtml"]=true;P[A]["html"]="<div class='f-tip'></div><div>"+ab+"</div>";P[A]["icon"]=A;P[A]["callback"]=D(ad)}}for(ai=0;ai<T;ai++){al=X[ai];A=al.iconClass||"edit"+ai;ab=al.text;af=al.statusScript||1;ad=al.evalScript;if(Fai.fkEval(af)!=-1){S=true;F=true;M[A]={};M[A]["name"]=ab;M[A]["usehtml"]=true;M[A]["html"]="<div class='f-tip'></div><div>"+ab+"</div>";M[A]["icon"]=A;M[A]["callback"]=D(ad)}}var ag=C.attr("_side"),z=C.attr("_flutterSwitch");if(ag==2&&Fai.top._canDesign){ad="Site.flutterStopSwitch('module"+I+"')";if(z=="true"){A="flutterStart";ab="开始飘动"}else{A="flutterStop";ab="停止飘动"}S=true;F=true;M[A]={};M[A]["name"]=ab;M[A]["usehtml"]=true;M[A]["html"]="<div class='f-tip'></div><div>"+ab+"</div>";M[A]["icon"]=A;M[A]["callback"]=D(ad);A="Location";ab="设为飘动起始位置";ad='Site.flutterSetStartLocation("module'+I+'")';M[A]={};M[A]["name"]=ab;M[A]["usehtml"]=true;M[A]["html"]="<div class='f-tip'></div><div>"+ab+"</div>";M[A]["icon"]=A;M[A]["callback"]=D(ad)}if(G.length>0&&Y(G)>0&&ae(I)){A="hasSub J_hasSub J_moreState";ab="设置模块状态";M[A]={};M[A]["name"]=ab;M[A]["usehtml"]=true;M[A]["html"]="<div class='f-tip'></div><div>"+ab+"</div>";M[A]["icon"]=A;M[A]["callback"]=function(){}}if(!am.isFullmeasure){Q++}if(H.length>0){Q+=Y(H)}if(Q>1){A="hasSub J_hasSub J_moreOpt";ab="更多操作";L[A]={};L[A]["name"]=ab;L[A]["usehtml"]=true;L[A]["html"]="<div class='f-tip'></div><div>"+ab+"</div>";L[A]["icon"]=A;L[A]["callback"]=function(){}}else{if(H.length>0){al=H[0];A=al.iconClass||"other"+ai;ab=al.text;af=al.statusScript||1;ad=al.evalScript;if(Fai.fkEval(af)!=-1){S=true;Z=true;L[A]={};L[A]["name"]=ab;L[A]["usehtml"]=true;L[A]["html"]="<div class='f-tip'></div><div>"+ab+"</div>";L[A]["icon"]=A;L[A]["callback"]=D(ad)}}if(!am.isFullmeasure){S=true;B=true;A="lockEdit";ab="锁定当前排版";K[A]={};K[A]["name"]=ab;K[A]["usehtml"]=true;K[A]["html"]="<div class='f-tip'></div><div>"+ab+"</div>";K[A]["icon"]=A;K[A]["callback"]=function(){if(i({name:"moduleLockEdit"})=="1"){jzUtils.run({name:"moduleEditTool.lockEdit",callMethod:true},d.id)}else{n("锁定当前模块排版后，该模块不能移动，会减少误操作，也可以复制被选中的模块内容。",function(){jzUtils.run({name:"moduleEditTool.lockEdit",callMethod:true},d.id)})}Site.logDog(100045,41)}}}}else{if(!am.isFullmeasure){S=true;B=true;A="openEdit";ab="解锁当前排版";K[A]={};K[A]["name"]=ab;K[A]["usehtml"]=true;K[A]["html"]="<div class='f-tip'></div><div>"+ab+"</div>";K[A]["icon"]=A;K[A]["callback"]=function(){jzUtils.run({name:"moduleEditTool.openEdit",callMethod:true},d.id);Site.logDog(100045,42)}}}if(am.inPack||N){p(C,am,J)}for(ai=0;ai<E.length;ai++){if(!q(W)&&!q(E[ai])){W["sep"+ai]="--"}W=$.extend(W,E[ai])}if(q(W)){Fai.ing("请将模块移离当前区域，再尝试右键操作",true);return false}return{items:W};function Y(ar){var ap=0,ao=ar.length,aq;for(var an=0;an<ao;an++){aq=ar[an].statusScript;if(aq&&Fai.fkEval(aq)!=-1){ap++}}return ap}function ae(ap){var an=$("#module"+ap);if(an.hasClass("formStyle97")&&!o(ap)){return false}else{if(Site.isCartModule(an)&&!ao(an)){return false}}return true;function ao(at){var av=Site.checkDockToModuleZone(at),ar,au,aq;ar=av.type==1;au=av.type==2;aq=ar||au;return aq}}function D(an){return function(ap,ao){Fai.fkEval(an);switch(ap){case"mtop":case"mbottom":case"mleft":case"mright":case"lock":case"dockModule":case"absModule":case"mzindex":case"flutterStop":Site.scrollToModuleDiv(Fai.top.$("#module"+d.id));Site.triggerGobalEvent("showFindModuleDiv",d.id);break;default:}}}},events:{show:function(){var A=Fai.top.$("#module"+d.id),C=w(A),E=-1,D,B;if(C.inTabId>0){E=C.inTabId}else{if(C.inMulColId>0){E=C.inMulColId}else{if(C.inFullmeasureId>0){E=C.inFullmeasureId}else{if(C.inPackId>0){E=C.inPackId}}}}if(E>0){D=Fai.top.$("#module"+E);Site.moduleEditTool.contextMenu(E,true)}Site.moduleEditTool.contextMenu(d.id,true);Site.removeAllEditLayer();Site.addMoveFrame("module"+d.id);if(A.attr("_side")=="2"&&A.attr("_flutterswitch")!="true"){A.attr("_edit",true);Site.stopFlutterInterval(A)}else{if(A.attr("_side")=="1"){A.off("mouseenter.sideModule").off("mouseleave.sideModule")}else{if(D&&D.length>0){B=D.attr("_side");if(B=="1"){D.off("mouseenter.sideModule").off("mouseleave.sideModule")}else{if(B=="2"&&D.attr("_flutterswitch")!="true"){D.attr("_edit",true);Site.stopFlutterInterval(D)}}}}}r=setTimeout(function(){var F=Fai.top.$("#module"+d.id);Site.addMoveFrame("module"+d.id);if(F.data("bottomLine")==1){Fai.top.$("#module"+d.id+"moveFrameBottom").css({opacity:1})}if(F.data("topLine")==1){Fai.top.$("#module"+d.id+"moveFrameTop").css({opacity:1})}if(F.data("leftLine")==1){Fai.top.$("#module"+d.id+"moveFrameLeft").css({opacity:1})}if(F.data("rightLine")==1){Fai.top.$("#module"+d.id+"moveFrameRight").css({opacity:1})}},200);var z=$(".fk-moduleContextMenu"+d.id);if(z.length>0){z.find(".J_hasSub").on({"mouseenter.subMenu":function(){f(d,$(this))},"mouseleave.subMenu":function(){m(d,$(this))}})}},hide:function(){clearTimeout(r);r=null;Site.removeMoveFrame("module"+d.id);var A=Fai.top.$("#module"+d.id),B=w(A),D=-1,C,z=$(".fk-moduleContextMenu"+d.id);if(z.length>0){z.off("mouseenter.subMenu mouseleave.subMenu")}if(B.inTabId>0){D=B.inTabId}else{if(B.inMulColId>0){D=B.inMulColId}else{if(B.inFullmeasureId>0){D=B.inFullmeasureId}else{if(B.inPackId>0){D=B.inPackId}}}}if(A.attr("_side")==2&&A.attr("_flutterswitch")!="true"){A.removeAttr("_edit");Site.startFlutterInterval(A)}else{if(A.attr("_side")==1){Site.reSetSidePosition(A)}}Site.moduleEditTool.contextMenu(d.id,false);if(D>0){C=Fai.top.$("#module"+D);Site.moduleEditTool.contextMenu(D,false);if(C.attr("_side")==2&&C.attr("_flutterswitch")!="true"){C.removeAttr("_edit");Site.startFlutterInterval(C)}else{if(C.attr("_side")==1){Site.reSetSidePosition(C)}}}}}});function j(A){var z=A.name||"",B=A.value,C=A.time||90;if(window.localStorage&&window.localStorage.setItem){window.localStorage.setItem(z,B)}else{$.cookie(z,B,{expires:C,path:"/"})}}function i(A){var z=A.name||"",B=false;if(window.localStorage&&window.localStorage.getItem){B=window.localStorage.getItem(z)}else{B=$.cookie(z,{path:"/"})}return B}function h(z){if(i({name:"moduleLockEdit"})=="1"){jzUtils.run({name:"moduleEditTool.lockEdit",callMethod:true},z.id)}else{n("锁定当前模块排版后，该模块不能移动，会减少误操作，也可以复制被选中的模块内容。",function(){jzUtils.run({name:"moduleEditTool.lockEdit",callMethod:true},z.id)})}Site.logDog(100045,41)}function u(E){var F=E.offset(),D=F.left,C=F.top,G=E.width(),z=E.height(),B=$(window),A=B.width(),H=B.height();if(D+G>A){E.addClass("fk-contextSubMenuWrap-right")}if(C+z>H){E.addClass("fk-contextSubMenuWrap-bottom")}}function t(B,A){function z(E,D){var F=[],C;F=F.concat(E.moduleStateList);F=F.concat(E.moduleOtherList);C=F.length;while(C){C--;if(F[C].iconClass===D){a(F[C].evalScript,D);return}}if(D==="lockEdit"){h(E)}}A.find(".J_subMenu").on("mouseup.subMenuItem",".J_subMenu-item",function(E){var F=$(this),C=F.attr("fk-icon-class");if(F.hasClass("J_subMenu-active")){E.stopPropagation();return}z(B,C);var D=Fai.top.$("#module"+B.id);if(D.hasClass("formStyle75")){Site.fixMsgSubmitStyle(B.id)}});A.off("mouseup.contextMenuItem mouseleave.removeActive").on({"mouseup.contextMenuItem":function(C){e(C,$(this))},"mouseleave.removeActive":function(){$(this).removeClass("context-menu-hover")}})}function g(A,z){z.find(".J_subMenu").off("mouseup.contextMenuItem");z.off("mouseup.contextMenuItem mouseleave.removeActive")}function e(z,I){var B=false,D=z.pageX,C=z.pageY,H=I.offset(),A=H.left,K=H.top,J=I.outerWidth(),E=I.outerHeight(),G=false,F=false;if(D>=A&&D<=(A+J)){G=true}if(C>=K&&C<=(K+E)){F=true}if(G&&F){z.stopPropagation()}}function f(C,A){var D,z,B;if(A.find(".J_subMenu").length>0){return}if(A.hasClass("J_moreState")){B=k(C)}else{if(A.hasClass("J_moreOpt")){B=c(C)}}if(!B){return}D=['<div class="fk-contextSubMenuWrap J_subMenuWrap">','<div class="fk-contextSubMenu J_subMenu">',B,"</div>","</div>"].join("");z=$(D);A.append(z);t(C,A);u(z)}function m(A,z){var B=z.find(".J_subMenuWrap");if(B.length==0){return}g(A,z);B.remove()}function k(z){var B=[],A;$(z.moduleStateList).each(function(H,C){var K=(C.iconClass||""),N=C.text.replace("模块","状态"),J=(C.statusScript||1),M="f-context-submenu-item J_subMenu-item f-subMenu-"+(C.iconClass||""),O=false,F;if(K=="dockModule"){var E=Fai.top.$("#module"+z.id),I=E.hasClass("formStyle97"),D=E.hasClass("formStyle82");if(I){if(!o(z.id)){return true}}else{if(D){var P=Site.checkDockToModuleZone(E),L,G;L=P.type==1;G=P.type==2;if(!(L||G)){return true}}}}if(y(z)==K){O=true;M+=" f-context-submenu-active J_subMenu-active"}if(Fai.fkEval(J)==-1&&!O){return}if(K=="absModule"){A=H}F=l({cls:M,text:N,iconClass:K});B.push(F)});if(A!==undefined){B.push(B.splice(A,1))}return B.join("")}function c(B){var A=B.moduleOtherList,E=B.id,D=Fai.top.$("#module"+E),F=w(D),C=[],z=[];C=C.concat(B.moduleOtherList);if(!F.isFullmeasure){C=C.concat({text:"锁定当前排版",iconClass:"lockEdit"})}$(C).each(function(H,G){var J="f-context-submenu-item J_subMenu-item f-subMenu-"+(G.iconClass||""),I;if(Fai.fkEval(G.statusScript)!=-1){I=l({cls:J,text:G.text,iconClass:G.iconClass})}z.push(I)});return z.join("")}function l(A){var z="<li class='{#cls#}' fk-icon-class='{#iconClass#}'><span class='f-point'></span>{#text#}</li>";z=z.replace("{#cls#}",(A.cls||"")).replace("{#text#}",(A.text||"")).replace("{#iconClass#}",(A.iconClass||""));return z}function y(A){var z=Site.getModuleStatus(A.id),B=["dockModule","absModule","lock","flutterm","sidem"];return B[z-1]}function a(A,z){Fai.fkEval(A);switch(z){case"mtop":case"mbottom":case"mleft":case"mright":case"lock":case"dockModule":case"absModule":case"mzindex":case"flutterStop":Site.scrollToModuleDiv(Fai.top.$("#module"+d.id));Site.triggerGobalEvent("showFindModuleDiv",d.id);break;default:}}function n(B,C){var A="<div style='line-height:20px;color:black;padding:7px 0 5px 0;font-size:12px;'>";A+="<p style='padding:20px 30px 0 30px;'>"+B+"</p>";A+="<div style='padding:10px 0 0 28px;'>";A+="<p style='padding:5px 0 5px 0;'>";A+="<input type='checkbox' name='save' id='jz-popupWindowForLockEdit' style='vertical-align:-2px;_vertical-align:-1px;' />";A+="<label for='jz-popupWindowForLockEdit' style='cursor:pointer;'>不再提示</label>";A+="</p>";A+="</div>";A+="</div>";var z=Fai.top.Fai.popupBodyWindow({title:"操作提示",content:A,width:360,height:120});Fai.top.Fai.addPopupBodyWindowBtn(z,{id:"save",text:"确定",extClass:"saveButton",click:function(){if(Fai.top.$("#jz-popupWindowForLockEdit").prop("checked")){j({name:"moduleLockEdit",value:"1",time:90})}C();Fai.top.Fai.closePopupBodyWindow(z)}});Fai.top.Fai.addPopupBodyWindowBtn(z,{id:"cancel",text:"取消",click:"close"})}function w(B){if(Object.prototype.toString.call(B).toLowerCase()!="[object object]"){throw new Error("contextMenu getModuleData 参数错误");return}var I=false,M=false,O=0,E=false,J=false,G=0,L=false,Q=false,D=0,F=false,A=false,P=false,N=false,z=0,H=false,K=false,C=0;if(B.hasClass("formStyle80")){I=true}else{if(B.hasClass("formStyle35")){L=true}else{if(B.hasClass("formStyle29")){E=true}else{if(B.hasClass("formStyle87")){P=true}else{if(B.hasClass("elemElemZone")){H=true}}}}}O=parseInt(B.attr("_infullmeasure"))||0;if(O>0){M=true}G=parseInt(B.attr("_intab"))||0;if(G>0){J=true}D=parseInt(B.attr("_inmulmcol"))||0;if(D>0){Q=true}z=parseInt(B.attr("_inpack"))||0;if(z>0){N=true}if(B.parent().hasClass("elemZone")){K=true;C=B.parent().attr("id")}if(E||L){F=true}if(J||Q){A=true}return{isFullmeasure:I,inFullmeasure:M,inFullmeasureId:O,isTab:E,inTab:J,inTabId:G,isMulCol:L,inMulCol:Q,inMulColId:D,isMultiModule:F,inMultiModule:A,isPack:P,inPack:N,inPackId:z,isElemZone:H,inElemZone:K,inElemZoneId:C}}function q(A){var z;for(z in A){return false}return true}function p(A,C,E){var D=A.nextAll(".form").length>0?false:true,B=A.prevAll(".form").length>0?false:true,I=A.siblings(".form").length>0?true:false,G=D?" f-isTop":"",H=B?" f-isBottom":"",F,z;if(!I){return}F="topIndex"+G;z="置于顶层";E[F]={};E[F]["name"]=z;E[F]["usehtml"]=true;E[F]["html"]="<div class='f-tip'></div><div>"+z+"</div>";E[F]["icon"]=F;E[F]["callback"]=function(){b(A);if(C.inPackId>0){Site.setModuleAttrDataChange(C.inPackId)}Fai.top._moduleMoved++;Site.styleChanged()};F="upIndex"+G;z="上移一层";E[F]={};E[F]["name"]=z;E[F]["usehtml"]=true;E[F]["html"]="<div class='f-tip'></div><div>"+z+"</div>";E[F]["icon"]=F;E[F]["callback"]=function(){x(A);if(C.inPackId>0){Site.setModuleAttrDataChange(C.inPackId)}Fai.top._moduleMoved++;Site.styleChanged()};F="downIndex"+H;z="下移一层";E[F]={};E[F]["name"]=z;E[F]["usehtml"]=true;E[F]["html"]="<div class='f-tip'></div><div>"+z+"</div>";E[F]["icon"]=F;E[F]["callback"]=function(){s(A);if(C.inPackId>0){Site.setModuleAttrDataChange(C.inPackId)}Fai.top._moduleMoved++;Site.styleChanged()};F="bottomIndex"+H;z="置于底层";E[F]={};E[F]["name"]=z;E[F]["usehtml"]=true;E[F]["html"]="<div class='f-tip'></div><div>"+z+"</div>";E[F]["icon"]=F;E[F]["callback"]=function(){v(A);if(C.inPackId>0){Site.setModuleAttrDataChange(C.inPackId)}Fai.top._moduleMoved++;Site.styleChanged()}}function b(z){var B=z.nextAll(".form"),A=B.length>0?false:true;if(!A){B.last().after(z)}}function x(z){var B=z.nextAll(".form"),A=B.length>0?false:true;if(!A){B.first().after(z)}}function v(B){var A=B.prevAll(".form"),z=A.length>0?false:true;if(!z){A.last().before(B)}}function s(B){var A=B.prevAll(".form"),z=A.length>0?false:true;if(!z){A.first().before(B)}}function o(z){var F=$("#module"+z),H=$("#fk-webHeaderZone"),I,J,D,B,A,C,G,E;if(H.length){if(F.hasClass("formInZone")){return true}I=H.offset().left;J=H.offset().top;D=H.width();B=H.height();A=F.offset().left;C=F.offset().top;G=F.width();E=F.height();if(I<A&&J<C&&(I+D>A+G)&&(J+B>C+E)){return true}}else{return false}}};Site.moduleEditTool={};(function(M,R,r){var L=[];var w=function(){var ah={};return{lock:function(ai){ah[ai]=ah[ai]||{};ah[ai].lock=true},open:function(ai){ah[ai]=ah[ai]||{};delete ah[ai].lock},getStatus:function(aj){var ai=false;if(ah[aj]){ai=ah[aj].status}return ai},getActivePart:function(aj){var ai=-1;if(ah[aj]){if("part" in ah[aj]){ai=ah[aj].part}}return ai},isActive:function(aj,ai){ah[aj]=ah[aj]||{};if(!!ah[aj].lock){return}ah[aj].status=true;if(ai=="tool"){ah[aj].part=1}else{if(ai=="dragBtn"){ah[aj].part=2}else{if(ai=="resizeCancel"){ah[aj].part=3}else{if(ai=="child"){ah[aj].part=4}else{ah[aj].part=0}}}}},getContextMenu:function(ai){ah[ai]=ah[ai]||{};return ah[ai].contextMenu||false},getMultiModule:function(ai){ah[ai]=ah[ai]||{};return ah[ai].multiModule||false},isLeave:function(ai){ah[ai]=ah[ai]||{};if(!!ah[ai].lock){return}ah[ai].status=false;delete ah[ai].part},onContextMenu:function(ai){ah[ai]=ah[ai]||{};ah[ai].contextMenu=true},offContextMenu:function(ai){ah[ai]=ah[ai]||{};ah[ai].contextMenu=false},onMultiModule:function(ai){ah[ai]=ah[ai]||{};ah[ai].multiModule=true},offMultiModule:function(ai){ah[ai]=ah[ai]||{};ah[ai].multiModule=false},clearAll:function(ai){delete ah[ai]}}}();R.init=function(ah){if(Object.prototype.toString.call(ah).toLowerCase()!="[object object]"){throw new Error("Site.moduleEditTool.init 参数错误");return}var ai=Fai.top.$("#module"+ah.id),aj;if(ai.length<1){return}ai.off("mousemove.moduleEdit").off("mouseleave.moduleEdit").off("mouseenter.moduleEdit").on("mousemove.moduleEdit",function(al){if(typeof aj=="number"){return}aj=setTimeout(function(){aj=null},300);Y(ah.id,"leaveParentModule");Y(ah.id,"leaveSideModule");Y(ah.id,"bindToolbarEvent_mouseleave");Y(ah.id,"initDrag");Y(ah.id,"bindToolbarEvent_mouseover");Y(ah.id,"initToolbar_mouseover");w.isActive(ah.id);var ak=I(M(this)),am=-1;if(ak.inTabId>0){am=ak.inTabId}else{if(ak.inMulColId>0){am=ak.inMulColId}else{if(ak.inFullmeasureId>0){am=ak.inFullmeasureId}else{if(ak.inPackId>0){am=ak.inPackId}}}}if(am>0){Y(am,"leaveParentModule");Y(am,"leaveSideModule");w.open(am);w.isActive(am,"child");w.lock(am)}V(ah);u(ah);Z(ah);ac(ah);l(ah);j(ah);if(!Fai.top.moveBtnExecuting&&!Fai.top.mouseoverLine){ad(ah.id)}}).on("mouseleave.moduleEdit",function(al){Y(ah.id,"leaveParentModule");Y(ah.id,"leaveSideModule");Y(ah.id,"bindToolbarEvent_mouseleave");w.isLeave(ah.id);var ak=I(M(this)),an=-1;if(ak.inTabId>0){an=ak.inTabId}else{if(ak.inMulColId>0){an=ak.inMulColId}else{if(ak.inFullmeasureId>0){an=ak.inFullmeasureId}else{if(ak.inPackId>0){an=ak.inPackId}}}}if(an>0){Y(an,"leaveParentModule");Y(an,"leaveSideModule");w.open(an);w.isLeave(an)}K(ah);p(ah);t(ah);a(ah);A(ah);Y(ah.id,"moduleEditMouseleave");var am=setTimeout(function(){if(!w.getStatus(ah.id)){C(ah)}},300);y(ah.id,"moduleEditMouseleave",am)}).on("mouseenter.moduleEdit",function(){Y(ah.id,"moduleEditMouseleave")});c(ah);F(ah);if(!Fai.top._canDesign){Site.removeDesignEditLayer()}if(!Fai.top._canEditData){Site.removeAllDataEditLayer()}ai.off("mouseenter.floatFutterBorder").on("mouseenter.floatFutterBorder",".ui-resizable-handle",function(){M(this).addClass("f-handleHover").siblings(".ui-resizable-handle").addClass("f-handleHover")});ai.off("mouseleave.floatFutterBorder").on("mouseleave.floatFutterBorder",".ui-resizable-handle",function(){M(this).removeClass("f-handleHover").siblings(".ui-resizable-handle").removeClass("f-handleHover")});if(ai.hasClass("formStyle86")){ai.off("mouseenter.editLine").on("mouseenter.editLine",".fk-editor-line",function(){M(this).siblings(".ui-resizable-handle").addClass("f-handleHover")});ai.off("mouseleave.editLine").on("mouseleave.editLine",".fk-editor-line",function(){M(this).siblings(".ui-resizable-handle").removeClass("f-handleHover")})}};R.remove=function(ah){C({id:ah})};R.contextMenu=function(ak,ah){var ai=I(Fai.top.$("#module"+ak)),aj=-1;if(ai.inTabId>0){aj=ai.inTabId}else{if(ai.inMulColId>0){aj=ai.inMulColId}else{if(ai.inFullmeasureId>0){aj=ai.inFullmeasureId}else{if(ai.inPackId>0){aj=ai.inPackId}}}}if(ah){w.onContextMenu(ak)}else{w.offContextMenu(ak)}U(ak);if(aj>0){if(ah){w.onContextMenu(aj)}else{w.offContextMenu(aj)}U(aj)}};R.lockEdit=function(ah){T(ah)};R.openEdit=function(ah){m(ah)};R.clickForOpenEdit=function(ah){m(ah);Fai.top.$("#module"+ah).children(".J_lockEditTip").addClass("fk-openEditTip").removeClass("fk-lockEditTip").removeAttr("onclick")};function c(ah){var ai=Fai.top.$("#module"+ah.id);if(ai.length<1){return}var aj=I(ai);if(aj.isMulCol||aj.isPack){ai.find(".formBanner"+ah.id).off("mouseover.moduleEdit").off("mouseleave.moduleEdit").on("mouseover.moduleEdit",function(){w.onMultiModule(ah.id)}).on("mouseleave.moduleEdit",function(){w.offMultiModule(ah.id)})}else{if(aj.isTab){ai.find(".titleTable").off("mouseover.moduleEdit").off("mouseleave.moduleEdit").on("mouseover.moduleEdit",function(){w.onMultiModule(ah.id)}).on("mouseleave.moduleEdit",function(){w.offMultiModule(ah.id)})}}}function b(ai){var aj=Fai.top.$("#fk-moduleToolbar"+ai.id),ah=Fai.top.$("#module"+ai.id);aj.off("mouseover.toolbar").off("mouseleave.toolbar").on("mouseover.toolbar",function(){var ak=Fai.top.$("#module"+ai.id),al=I(ak),ao=-1,am;if(al.inTabId>0){ao=al.inTabId}else{if(al.inMulColId>0){ao=al.inMulColId}else{if(al.inFullmeasureId>0){ao=al.inFullmeasureId}else{if(al.inPackId>0){ao=al.inPackId}}}}Y(ai.id,"dragBtnMouseover");Y(ai.id,"resizeCancelBtnMouseleave");Y(ai.id,"leaveSideModule");Y(ai.id,"leaveParentModule");w.open(ai.id);w.isActive(ai.id,"tool");O(ai.id);E(ai.id);if(ak.parent().hasClass("fk-inBannerListZone")&&Fai.top._bannerV2Data.bl&&Fai.top._bannerV2Data.bl.length>1){Site.bannerV2.stopBannerInterval()}if(ao>0){w.open(ao);w.isActive(ao,"child");w.lock(ao);Y(ao,"leaveSideModule");Y(ao,"leaveParentModule")}if(al.inFullmeasureId>0){M("#module"+al.inFullmeasureId).data("mouseenter",true)}if(ak.hasClass("formStyle80")){ak.data("mouseenter",true)}if(ak.attr("_side")=="2"){Site.stopFlutterInterval(ak)}if(ao>0){am=Fai.top.$("#module"+ao);if(am.attr("_side")=="2"){Site.stopFlutterInterval(am)}}Y(ai.id,"bindToolbarEvent_mouseleave");Y(ai.id,"bindToolbarEvent_mouseover");var an=setTimeout(function(){if(w.getStatus(ai.id)&&w.getActivePart(ai.id)==1){X(ai.id);P(ai.id);if(ao>0){X(ao)}}},300);y(ai.id,"bindToolbarEvent_mouseover",an)}).on("mouseleave.toolbar",function(){var ak=Fai.top.$("#module"+ai.id),al=I(ak),an=-1;if(al.inTabId>0){an=al.inTabId}else{if(al.inMulColId>0){an=al.inMulColId}else{if(al.inFullmeasureId>0){an=al.inFullmeasureId}else{if(al.inPackId>0){an=al.inPackId}}}}if(an>0){w.open(an);w.isLeave(an)}if(al.inFullmeasureId>0){M("#module"+al.inFullmeasureId).data("mouseenter",false)}if(ak.hasClass("formStyle80")){ak.data("mouseenter",false)}w.open(ai.id);w.isLeave(ai.id);Y(ai.id,"bindToolbarEvent_mouseover");Y(ai.id,"bindToolbarEvent_mouseleave");var am=setTimeout(function(){if(!w.getStatus(ai.id)){C(ai)}},300);y(ai.id,"bindToolbarEvent_mouseleave",am)});if(Site.simpleTip){if(ah.hasClass("formStyle80")){Site.simpleTip(aj.find(".J_title"),0)}else{Site.simpleTip(aj.find(".J_icon"),0)}}}function x(ah){Fai.top.$("#fk-moduleToolbar"+ah).remove()}function W(al){var at=al.id,aj=al.toolList,az=aj.length||0,ay=0,aq=[],aC,aw,aB,aD,ar,ak,an;if(aj.length<0){return}var ah=Fai.top.$("#fk-moduleToolbar"+at);if(ah.length>0){s(at);return}var ai=Fai.top.$("#module"+at),au=I(ai),aA=Site.getModuleAttrPattern(at),am="",ap=false;var ax="",av="",ao="";ax+=" fk-moduleToolbar-v2 ";if(au.isFullmeasure){am=" fk-moduleToolbar-fullmeasure-v2 "}if(aA.border.y===1&&aA.bannerType===1&&aA.contentBg.y===1){ap=true}aq.push("<div id='fk-moduleToolbar"+at+"' class=' J_moduleToolbar "+ax+am+"'>");if(au.isFullmeasure){for(ay=0;ay<az;ay++){aC=aj[ay];aw=true;if(aC.statusScript){if(Fai.fkEval(aC.statusScript)==-1){aw=false}}if(!aw){continue}an=aC.toolDisplay;aB=aC.evalScript;ar=aC.text||"";aD=aC.text||"";ay!=0&&(av=" data-title-tip='"+aD+"' ");ak=aC.toolClass||"";if(ak=="moduleLayerIconCarousel"){if(ai.data("stopCarousel")==true){ak="moduleLayerIconStop";ar="自动轮播";aD="自动轮播"}}if(an=="toolIcon"){ar="&nbsp;"}ao="";if(az!=1&&ay==0){ao+="f-toolItemLine"}aq.push("<div class='f-toolItem J_toolItem f-toolItem"+ak+"  "+ao+" '>");aq.push("<a class='f-title J_title' "+av+' onclick="'+aB+';Site.removeAllEditLayer();return false;">'+ar+"</a>");aq.push("</div>")}}else{for(ay=0;ay<az;ay++){aC=aj[ay];aw=true;if(aC.statusScript){if(Fai.fkEval(aC.statusScript)==-1){aw=false}}if(!aw){continue}aB=aC.evalScript;aD=aC.text||"";ak=aC.iconClass||"";if(aC.setTB&&aw){if(ap){ak="resetTB";aD="显示外框";aB="Site.oneKeySetModuleTB("+at+", false)"}else{ak="clearTB";aD="隐藏外框";aB="Site.oneKeySetModuleTB("+at+", true)"}}ao="";if(az!=1&&ay==0){ao+="f-toolItemLine"}if(ak=="text"&&(ay!=0&&ay<az-1)){ao+="f-toolItemLine"}if(au.isTab&&ay==0){aD=au.isTabY?"编辑纵向标签":"编辑横向标签"}aq.push("<div class='f-toolItem J_toolItem f-toolItem"+ak+"  "+ao+" '>");if(ai.parent().hasClass("fk-inBannerListZone")&&Fai.top._bannerV2Data.bl&&Fai.top._bannerV2Data.bl.length>1){aq.push("<a class='f-title J_title' onclick=\""+aB+";Site.bannerV2.stopBannerInterval();Site.removeAllEditLayer();return false;\"><span class='J_icon f-icon' data-title-tip='"+aD+"' ></span><span class='f-icon f-onlyIcon' title='"+aD+"'></span><span class='f-text'>"+aD+"</span></a>")}else{aq.push("<a class='f-title J_title' onclick=\""+aB+";Site.removeAllEditLayer();return false;\"><span class='J_icon f-icon' data-title-tip='"+aD+"' ></span><span class='f-icon f-onlyIcon' title='"+aD+"'></span><span class='f-text'>"+aD+"</span></a>")}aq.push("</div>")}}aq.push("</div>");Fai.top.$("body").append(aq.join(""));s(at);b(al)}function V(ah){if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){ag(ah.id);return}Y(ah.id,"initToolbar_mouseover");var ai=setTimeout(function(){var ak=Fai.top.$("#module"+ah.id),aj=I(ak);if(w.getStatus(ah.id)&&w.getActivePart(ah.id)!=4){if(aj.isMultiModule||aj.isPack){if(w.getMultiModule(ah.id)){if(!ak.data("simpleText")&&!ak.data("floatImg")&&!ak.data("floatBtn")){W(ah);O(ah.id)}N(ak,ah.id)}else{W(ah);N(ak,ah.id);if(w.getActivePart(ah.id)!=2&&w.getActivePart(ah.id)!=1){ag(ah.id)}}}else{if(aj.isPack){}else{if(!ak.data("simpleText")&&!ak.data("floatImg")&&!ak.data("floatBtn")){W(ah);O(ah.id)}N(ak,ah.id)}}}else{ag(ah.id)}},100);y(ah.id,"initToolbar_mouseover",ai)}function K(ah){Y(ah.id,"initToolbar_mouseleave");var ai=setTimeout(function(){var aj=Fai.top.$("#module"+ah.id);if(!w.getStatus(ah.id)){ag(ah.id)}},100);y(ah.id,"initToolbar_mouseleave",ai)}R.hidePaddingMarginWrap=function(aj){var ai=Fai.top.$("#module"+aj),ah=ai.find(">.J_paddingMarginWrap");if(ah.length<1){return}ah.find(".J_setting_btn_box").hide()};function aa(aj){var ai=Fai.top.$("#module"+aj),ah=ai.find(">.J_paddingMarginWrap");if(ah.length>0){ah.remove()}}function ad(ak){var aj=Fai.top.$("#module"+ak),ai="",ah;if(!Fai.top._designAuth){return}if(D(aj,ak)==-1){return}ah=aj.find(">.J_paddingMarginWrap");if(ah.length<1){ai='<div class="fk-paddingMarginWrap J_paddingMarginWrap"><div class="top-area J_setting_area J_top_area" direction="top"><div class="top-line J_top_line"></div><div class="fk-top-setting-btn J_top_setting_btn J_setting_btn_box" style="display:none"><a class="fk-top-padding-btn J_top_padding_btn fk-setting-btn" ></a><a class="fk-top-margin-btn J_top_margin_btn fk-setting-btn" ></a></div></div><div class="left-area J_setting_area J_left_area" direction="left"><div class="left-line J_left_line"></div><div class="fk-left-setting-btn J_left_setting_btn J_setting_btn_box" style="display:none"><a class="fk-left-padding-btn J_left_padding_btn fk-setting-btn" ></a><a class="fk-left-margin-btn J_left_margin_btn fk-setting-btn" ></a></div></div><div class="right-area J_setting_area J_right_area" direction="right"><div class="right-line J_right_line"></div><div class="fk-right-setting-btn J_right_setting_btn J_setting_btn_box" style="display:none"><a class="fk-right-padding-btn J_right_padding_btn fk-setting-btn" ></a><a class="fk-right-margin-btn J_right_margin_btn fk-setting-btn" ></a></div></div><div class="bottom-area J_setting_area J_bottom_area" direction="bottom"><div class="bottom-line J_bottom_line"></div><div class="fk-bottom-setting-btn J_bottom_setting_btn J_setting_btn_box" style="display:none"><a class="fk-bottom-padding-btn J_bottom_padding_btn fk-setting-btn" ></a><a class="fk-module-height-btn J_bottom_height_btn" ></a><a class="fk-bottom-margin-btn J_bottom_margin_btn fk-setting-btn" ></a></div></div></div>';aj.append(ai);ah=aj.find(">.J_paddingMarginWrap");z(ak,aj,ah);H(ak,0);J(ak)}else{ah.find(".J_setting_btn_box").hide();z(ak,aj,ah);H(ak,0)}}function D(al,an){var ah=1,am=Site.getModuleStatus(an),ak=Site.checkNestModule(al),ai=Site.checkModuleInZone(al),aj=Site.getModuleAttrPattern(an);if(al.hasClass("formStyle81")||al.hasClass("formStyle86")||al.hasClass("formStyle79")||al.hasClass("formStyle82")||al.hasClass("formStyle97")||al.hasClass("formStyle45")||al.hasClass("formStyle39")||al.hasClass("formStyle62")||al.hasClass("formStyle66")||al.hasClass("formStyle65")){ah=-1}if(ak.inTab||ak.inCol||ak.isFullmeasure||ak.isTab){ah=-1}if(am==3||am==4||am==5){ah=-1}if(ak.isPack&&am==2){ah=-1}if((am==2||ak.inPack||ai)&&aj.border.y==1&&aj.bannerType==1&&aj.contentBg.y==1){aa(an);ah=-1}return ah}function z(ai,ap,ar){var ah=Site.getModuleStatus(ai),aq=Site.checkNestModule(ap),ak=ar.find(".J_setting_btn_box"),ao=Site.checkModuleInZone(ap),an=Site.getModuleAttrPattern(ai),al=true,am=true,aj=true;if(ah==2||aq.inPack||ao||aq.inElemZone){am=false}if(aq.isPack||(an.border.y==1&&an.bannerType==1&&an.contentBg.y==1)){al=false}if(!al||!am){aj=false}if(!am){ar.addClass("fk-paddingMarginWrap-float");ak.find(".J_top_margin_btn").hide();ak.find(".J_left_margin_btn").hide();ak.find(".J_right_margin_btn").hide();ak.find(".J_bottom_margin_btn").hide()}else{ar.removeClass("fk-paddingMarginWrap-float");ak.find(".J_top_margin_btn").show();ak.find(".J_left_margin_btn").show();ak.find(".J_right_margin_btn").show();ak.find(".J_bottom_margin_btn").show()}if(!al){ar.addClass("fk-paddingMarginWrap-pack");ak.find(".J_top_padding_btn").hide();ak.find(".J_left_padding_btn").hide();ak.find(".J_right_padding_btn").hide();ak.find(".J_bottom_padding_btn").hide()}else{ar.removeClass("fk-paddingMarginWrap-pack");ak.find(".J_top_padding_btn").show();ak.find(".J_left_padding_btn").show();ak.find(".J_right_padding_btn").show();ak.find(".J_bottom_padding_btn").show()}if(!aj){ak.find(".J_bottom_height_btn").hide()}else{ak.find(".J_bottom_height_btn").show()}if(aq.isCol||aq.isPack||aq.isTab){ar.addClass("fk-paddingMarginWrap-multiM")}else{ar.removeClass("fk-paddingMarginWrap-multiM")}}function H(ar,au){var am=Fai.top.$("#module"+ar),aj=am.find(">.J_paddingMarginWrap"),an,az,ai,aw,al,at,ak,ay,ap,ao=0,aq=false,av,ax=0,ah=0;if(aj.length<1){return}av=Site.getModuleAttrPattern(ar).border;an=am.innerWidth();az=am.innerHeight();ai=am.offset().top;ap=M(window).height();if(az>=300){if(ai>0){ao=ap-ai;if(ao>=300){aq=true}}else{ao=az+ai;if(ao>=300){aq=true}}if(ao>ap){ao=ap}if(ao>az){ao=az}}if(!!av&&av.y!=0){ax=am.css("border-top-width");if(ax.indexOf("px")!=-1){ax=parseInt(ax)}else{ax=0}ah=am.css("border-left-width");if(ah.indexOf("px")!=-1){ah=parseInt(ah)}else{ah=0}}if(au==0||au==1){aj.find(".J_top_area").width(an)}if(au==0||au==2){if(aq){aj.find(".J_left_area").height(ao);if(ai<0){aj.find(".J_left_area").css("top",-ai+"px")}else{aj.find(".J_left_area").css("top","0")}}else{aj.find(".J_left_area").height(az)}}if(au==0||au==3){if(aj.hasClass("fk-paddingMarginWrap-float")){ay=am.offset().left+ah-13}else{ay=am.offset().left+ah-10}aj.find(".J_right_area").offset({left:an+ay});if(aq){aj.find(".J_right_area").height(ao);if(ai<0){aj.find(".J_right_area").css("top",-ai+"px")}else{aj.find(".J_right_area").css("top","0")}}else{aj.find(".J_right_area").height(az)}}if(au==0||au==4){ak=ai+ax-10;aj.find(".J_bottom_area").width(an);aj.find(".J_bottom_area").offset({top:az+ak})}}function h(am,ai){var al=Fai.top.$("#module"+am),ah=al.find(">.J_paddingMarginWrap"),ak,aj;if(ah.length<1){return}ah.show();aj=ah.find(".J_setting_btn_box").hide();if(ai==0||ai==1){ak=ah.find(".J_top_setting_btn");ak.show()}if(ai==0||ai==2){ak=ah.find(".J_left_setting_btn");ak.show()}if(ai==0||ai==3){ak=ah.find(".J_right_setting_btn");ak.show()}if(ai==0||ai==4){ak=ah.find(".J_bottom_setting_btn");ak.show()}}function J(az){var an=M("#module"+az),aC=Site.getModuleAttrPattern(az),ak=an.find(">.J_paddingMarginWrap"),ai=ak.find(".J_setting_area"),aq,aD,ah,al,ar,ap,at,aF,aj,aA,aG,am,aE,aH;var av=Fai.top.$("#dockTip");if(av.length<1){av=M("<div id='dockTip' class='resizableToShowWidth dockTip'></div>");Fai.top.$("body").append(av)}an.children(".ui-resizable-s").off("mouseenter.btn").on("mouseenter.btn",function(){if(!!Fai.top.moveBtnExecuting){return}h(az,4);Fai.top.mouseoverLine=true});an.children(".ui-resizable-n").off("mouseenter.btn").on("mouseenter.btn",function(){if(!!Fai.top.moveBtnExecuting){return}h(az,1);Fai.top.mouseoverLine=true});an.children(".ui-resizable-w").off("mouseenter.btn").on("mouseenter.btn",function(){if(!!Fai.top.moveBtnExecuting){return}h(az,2);Fai.top.mouseoverLine=true});an.children(".ui-resizable-e").off("mouseenter.btn").on("mouseenter.btn",function(){if(!!Fai.top.moveBtnExecuting){return}h(az,3);Fai.top.mouseoverLine=true});ai.off("mouseover.btn").on("mouseover.btn",function(aJ){var aK=M(this).attr("direction");var aI=M(aJ.target);if(!!Fai.top.moveBtnExecuting){return}Fai.top.mouseoverLine=true;if(aK=="top"){h(az,1)}else{if(aK=="left"){h(az,2)}else{if(aK=="right"){h(az,3)}else{if(aK=="bottom"){h(az,4)}}}}if(aI.hasClass("J_bottom_padding_btn")){av.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){av.show().text("按住鼠标拖动，可随意调整下内边距");d(aI.parent(),av,7)},200)}else{if(aI.hasClass("J_bottom_margin_btn")){av.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){av.show().text("按住鼠标拖动，可随意调整下外边距");d(aI.parent(),av,8)},200)}else{if(aI.hasClass("J_top_padding_btn")){av.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){av.show().text("按住鼠标拖动，可随意调整上内边距");d(aI.parent(),av,1)},200)}else{if(aI.hasClass("J_top_margin_btn")){av.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){av.show().text("按住鼠标拖动，可随意调整上外边距");d(aI.parent(),av,2)},200)}else{if(aI.hasClass("J_left_padding_btn")){av.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){av.show().text("按住鼠标拖动，可随意调整左内边距");d(aI.parent(),av,3)},200)}else{if(aI.hasClass("J_left_margin_btn")){av.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){av.show().text("按住鼠标拖动，可随意调整左外边距");d(aI.parent(),av,4)},200)}else{if(aI.hasClass("J_right_padding_btn")){av.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){av.show().text("按住鼠标拖动，可随意调整右内边距");d(aI.parent(),av,5)},200)}else{if(aI.hasClass("J_right_margin_btn")){av.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){av.show().text("按住鼠标拖动，可随意调整右外边距");d(aI.parent(),av,6)},200)}else{if(aI.hasClass("J_bottom_height_btn")){av.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.isShowTipTime=setTimeout(function(){av.show().text("按住鼠标拖动，可随意调整高度");d(an,av,9)},200)}}}}}}}}}}).off("mouseleave.btn").on("mouseleave.btn",function(){if(!!Fai.top.moveBtnExecuting){return}av.hide();clearTimeout(Fai.top.isShowTipTime);Fai.top.mouseoverLine=false});an.off("mouseleave.PMbtn").on("mouseleave.PMbtn",function(){if(!!Fai.top.moveBtnExecuting){return}Fai.top.mouseoverLine=false;R.hidePaddingMarginWrap(az)});Fai.top.$("#g_main").off("scroll.forDockTip").on("scroll.forDockTip",function(){if(!!Fai.top.moveBtnExecuting){return}av.hide()});ak.find(".J_top_padding_btn").draggable("destroy").draggable({handle:".J_top_padding_btn",axis:"y",revert:true,helper:function(){var aI='<div class="fk-paddingLine J_paddingMarginLine"></div>';return M(aI)},start:function(aI,aJ){Fai.top.moveBtnExecuting=true;M(this).parent().show();av.show();ay(1);Site.disableEditLayer();M(this).addClass("fk-top-padding-selected");aq=aJ.offset.top;ah=parseInt(an.find(".formMiddleContent"+az).css("margin-top").replace("px",""))},drag:function(aJ,aK){var aI=aK.offset.top-aq+ah;aw(2,aI);d(M(this).parent(),av,1);H(az,0)},stop:function(aI,aJ){M(this).removeClass("fk-top-padding-selected");av.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;ay(0);Site.enableEditLayer();aB();ao(az,1)}});ak.find(".J_top_margin_btn").draggable("destroy").draggable({handle:".J_top_margin_btn",axis:"y",revert:true,helper:function(){var aI='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aI)},start:function(aI,aJ){Fai.top.moveBtnExecuting=true;M(this).parent().show();av.show();ay(1);Site.disableEditLayer();M(this).addClass("fk-top-margin-selected");aq=aJ.offset.top;aD=parseInt(an.css("margin-top").replace("px",""))},drag:function(aI,aK){var aJ=aK.offset.top-aq+aD;au(2,aJ);d(M(this).parent(),av,2)},stop:function(aI,aJ){M(this).removeClass("fk-top-margin-selected");av.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;ay(0);Site.enableEditLayer();aB();Site.logDog(100045,47)}});ak.find(".J_left_padding_btn").draggable("destroy").draggable({handle:".J_left_padding_btn",axis:"x",revert:true,helper:function(){var aI='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aI)},start:function(aI,aJ){Fai.top.moveBtnExecuting=true;M(this).parent().show();av.show();ay(1);Site.disableEditLayer();M(this).addClass("fk-left-padding-selected");al=aJ.offset.left;ap=parseInt(an.find(".formMiddleContent"+az).css("margin-left").replace("px",""))},drag:function(aJ,aK){var aI=aK.offset.left-al+ap;aw(0,aI);d(M(this).parent(),av,3);H(az,4)},stop:function(aI,aJ){M(this).removeClass("fk-left-padding-selected");av.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;ay(0);Site.enableEditLayer();aB();ao(az,2)}});ak.find(".J_left_margin_btn").draggable("destroy").draggable({handle:".J_left_margin_btn",axis:"x",revert:true,helper:function(){var aI='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aI)},start:function(aI,aJ){Fai.top.moveBtnExecuting=true;M(this).parent().show();av.show();ay(1);Site.disableEditLayer();M(this).addClass("fk-left-margin-selected");al=aJ.offset.left;ar=parseInt(an.css("margin-left").replace("px",""))},drag:function(aI,aK){var aJ=aK.offset.left-al+ar;au(0,aJ);d(M(this).parent(),av,4);H(az,3)},stop:function(aI,aJ){M(this).removeClass("fk-left-margin-selected");av.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;ay(0);Site.enableEditLayer();aB();Site.logDog(100045,49)}});ak.find(".J_right_padding_btn").draggable("destroy").draggable({handle:".J_right_padding_btn",axis:"x",revert:true,helper:function(){var aI='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aI)},start:function(aI,aJ){Fai.top.moveBtnExecuting=true;M(this).parent().show();av.show();ay(1);Site.disableEditLayer();M(this).addClass("fk-right-padding-selected");at=aJ.offset.left;aj=parseInt(an.find(".formMiddleContent"+az).css("margin-right").replace("px",""))},drag:function(aI,aJ){var aK=at-aJ.offset.left+aj;aw(1,aK);d(M(this).parent(),av,5);H(az,4)},stop:function(aI,aJ){M(this).removeClass("fk-right-padding-selected");av.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;ay(0);Site.enableEditLayer();aB();ao(az,3)}});ak.find(".J_right_margin_btn").draggable("destroy").draggable({handle:".J_right_margin_btn",axis:"x",revert:true,helper:function(){var aI='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aI)},start:function(aI,aJ){Fai.top.moveBtnExecuting=true;M(this).parent().show();av.show();ay(1);Site.disableEditLayer();M(this).addClass("fk-right-margin-selected");at=aJ.offset.left;aF=parseInt(an.css("margin-right").replace("px",""))},drag:function(aI,aK){var aJ=at-aK.offset.left+aF;au(1,aJ);d(M(this).parent(),av,6);H(az,0)},stop:function(aI,aJ){M(this).removeClass("fk-right-margin-selected");av.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;ay(0);Site.enableEditLayer();aB();Site.logDog(100045,50)}});ak.find(".J_bottom_padding_btn").draggable("destroy").draggable({handle:".J_bottom_padding_btn",axis:"y",revert:true,helper:function(){var aI='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aI)},start:function(aI,aJ){Fai.top.moveBtnExecuting=true;M(this).parent().show();av.show();ay(1);Site.disableEditLayer();M(this).addClass("fk-bottom-padding-selected");aA=aJ.offset.top;am=parseInt(an.find(".formMiddleContent"+az).css("margin-bottom").replace("px",""))},drag:function(aI,aJ){var aK=aJ.offset.top-aA+am;aw(3,aK);d(M(this).parent(),av,7);H(az,0)},stop:function(aI,aJ){M(this).removeClass("fk-bottom-padding-selected");av.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;ay(0);Site.enableEditLayer();aB();ao(az,4)}});ak.find(".J_bottom_margin_btn").draggable("destroy").draggable({handle:".J_bottom_margin_btn",axis:"y",revert:true,helper:function(){var aI='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aI)},start:function(aI,aJ){Fai.top.moveBtnExecuting=true;M(this).parent().show();av.show();ay(1);Site.disableEditLayer();M(this).addClass("fk-bottom-margin-selected");aA=aJ.offset.top;aG=parseInt(an.css("margin-bottom").replace("px",""))},drag:function(aI,aJ){var aK=aJ.offset.top-aA+aG;au(3,aK);d(M(this).parent(),av,8)},stop:function(aI,aJ){M(this).removeClass("fk-bottom-margin-selected");av.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;ay(0);Site.enableEditLayer();aB();Site.logDog(100045,48)}});var ax=null;ak.find(".J_bottom_height_btn").draggable("destroy").draggable({handle:".J_bottom_height_btn",axis:"y",revert:true,helper:function(){var aI='<div class="fk-MarginLine J_paddingMarginLine"></div>';return M(aI)},start:function(aI,aJ){Fai.top.moveBtnExecuting=true;M(this).addClass("fk-module-height-selected");M(this).parent().show();av.show();ay(1);Site.disableEditLayer();aE=aJ.offset.top;aH=parseInt(an.css("height").replace("px",""));an.attr("_autoheight",0)},drag:function(aJ,aK){if(typeof ax=="number"){return}ax=setTimeout(function(){ax=null},60);var aI=aK.offset.top-aE+aH;if(aI<0||aI>2000){return}if(aI>=0&&aI<10){aI=10}an.css("height",aI+"px");av.text("高度 : "+aI);H(az,0);d(an,av,9);Site.refreshModuleHeightForStop(an,az)},stop:function(aI,aJ){M(this).removeClass("fk-module-height-selected");av.hide();M(this).parent().hide();Fai.top.moveBtnExecuting=false;Fai.top.mouseoverLine=false;ay(0);Site.enableEditLayer();aB();Site.logDog(100045,59)}});function au(aI,aL){var aJ=parseInt(an.parent().outerWidth()/2),aM=aC.outside,aK;aM.y=1;Site.setModuleStyleCss(az,"","padding",0+"px");if(aI==0){if(aL<-500){return}if(aL>=-500&&aL<0){aL=0}if(typeof aM.r=="undefined"){aM.r=0}aK=aJ-aM.r;if(aL>aK){aL=aK}aM.l=aL;if(aL==0){av.html("左外边距 : "+aL+"<br>外边距不支持拖动负值，请往右拖")}else{if(aL==aK){av.html("左外边距 : "+aL+"<br>左右外边距的和，不能超过"+aJ+"px")}else{av.text("左外边距 : "+aL)}}Site.setModuleStyleCss(az,"","margin-left",aL+"px")}else{if(aI==1){if(aL<-500){return}if(aL>=-500&&aL<0){aL=0}if(typeof aM.l=="undefined"){aM.l=0}aK=aJ-aM.l;if(aL>aK){aL=aK}aM.r=aL;if(aL==0){av.html("右外边距 : "+aL+"<br>外边距不支持拖动负值，请往左拖")}else{if(aL==aK){av.html("右外边距 : "+aL+"<br>左右外边距的和，不能超过"+aJ+"px")}else{av.text("右外边距 : "+aL)}}Site.setModuleStyleCss(az,"","margin-right",aL+"px")}else{if(aI==2){if(aL<-500){return}if(aL>=-500&&aL<0){aL=0}if(aL>1000){aL=1000}aM.t=aL;if(aL==0){av.html("上外边距 : "+aL+"<br>外边距不支持拖动负值，请往下拖")}else{if(aL==1000){av.html("上外边距 : "+aL+"<br>拖动范围为小于1000的数值")}else{av.text("上外边距 : "+aL)}}Site.setModuleStyleCss(az,"","margin-top",aL+"px")}else{if(aI==3){if(aL<-500){return}if(aL>=-500&&aL<0){aL=0}if(aL>1000){aL=1000}aM.b=aL;if(aL==0){av.html("下外边距 : "+aL+"<br>外边距不支持拖动负值，请往下拖")}else{if(aL==1000){av.html("下外边距 : "+aL+"<br>拖动范围为小于1000的数值")}else{av.text("下外边距 : "+aL)}}Site.setModuleStyleCss(az,"","margin-bottom",aL+"px")}}}}Site.refreshModuleHeight(az)}function aw(aI,aM){var aJ=aC.inner,aK=parseInt(an.outerWidth()/2),aL;aJ.y=1;Site.setModuleStyleCss(az,".formMiddleContent"+az,"padding",0+"px");if(aI==0){if(aM<-100){aM=-100}if(typeof aJ.r=="undefined"){aJ.r=0}aL=aK-aJ.r;if(aM>aL){aM=aL}aJ.l=aM;if(aM==-100){av.html("左内边距 : "+aM+"<br>拖动范围为大于等于-100的数值")}else{if(aM==aL){av.html("左内边距 : "+aM+"<br>左右内边距的和，不能超过"+aK+"px")}else{av.text("左内边距 : "+aM)}}if(an.hasClass("formStyle76")){Site.setModuleStyleCss(az,".formMiddleContent"+az+" .p_m_cotainer","padding-left",aM+"px")}else{Site.setModuleStyleCss(az,".formMiddleContent"+az,"margin-left",aM+"px")}}else{if(aI==1){if(aM<-100){aM=-100}if(typeof aJ.l=="undefined"){aJ.l=0}aL=aK-aJ.l;if(aM>aL){aM=aL}aJ.r=aM;if(aM==-100){av.html("右内边距 : "+aM+"<br>拖动范围为大于等于-100的数值")}else{if(aM==aL){av.html("右内边距 : "+aM+"<br>左右内边距的和，不能超过"+aK+"px")}else{av.text("右内边距 : "+aM)}}if(an.hasClass("formStyle76")){Site.setModuleStyleCss(az,".formMiddleContent"+az+" .p_m_cotainer","padding-right",aM+"px")}else{Site.setModuleStyleCss(az,".formMiddleContent"+az,"margin-right",aM+"px")}}else{if(aI==2){if(aM<-100||aM>=1000){aM=aM<-100?-100:999}aJ.t=aM;if(aM==-100||aM==999){av.html("上内边距 : "+aM+"<br>拖动范围为大于等于-100，小于1000的数值")}else{av.text("上内边距 : "+aM)}Site.setModuleStyleCss(az,".formMiddleContent"+az,"margin-top",aM+"px")}else{if(aI==3){if(aM<-100||aM>=1000){aM=aM<-100?-100:999}aJ.b=aM;if(aM==-100||aM==999){av.html("下内边距 : "+aM+"<br>拖动范围为大于等于-100，小于1000的数值")}else{av.text("下内边距 : "+aM)}Site.setModuleStyleCss(az,".formMiddleContent"+az,"margin-bottom",aM+"px")}}}}Site.refreshModuleHeight(az)}function aB(){aC.changed=true;Site.styleChanged()}function ay(aI){if(aI==1){an.addClass("form-for-paddingMargin-wrap")}else{an.removeClass("form-for-paddingMargin-wrap")}}function ao(aK,aI){var aJ=Site.getModuleStatus(aK);if(aJ==2){switch(aI){case 1:Site.logDog(100045,55);break;case 2:Site.logDog(100045,57);break;case 3:Site.logDog(100045,58);break;case 4:Site.logDog(100045,56);break;default:}}else{if(aJ==1){switch(aI){case 1:Site.logDog(100045,51);break;case 2:Site.logDog(100045,53);break;case 3:Site.logDog(100045,54);break;case 4:Site.logDog(100045,52);break;default:}}}}}function d(ap,al,ao){var am,aj,an,ak,ah,ai;if(ap.length<1||al.length<1){return}am=ap.offset().top;aj=ap.offset().left;if(ao==1){ah=al.outerWidth();al.offset({top:am,left:aj-ah-10})}else{if(ao==2){an=ap.outerWidth();al.offset({top:am,left:aj+an+10})}else{if(ao==3){ai=al.outerHeight();al.offset({top:am-ai-10,left:aj})}else{if(ao==4){ak=ap.outerHeight();al.offset({top:am+ak+10,left:aj})}else{if(ao==5){ai=al.outerHeight();an=ap.outerWidth();ah=al.outerWidth();al.offset({top:am-ai-10,left:aj+an-ah})}else{if(ao==6){ak=ap.outerHeight();an=ap.outerWidth();ai=al.outerHeight();ah=al.outerWidth();al.offset({top:am+ak+10,left:aj+an-ah})}else{if(ao==7){ak=ap.outerHeight();ah=al.outerWidth();ai=al.outerHeight();al.offset({top:am+ak-ai,left:aj-ah-10})}else{if(ao==8){ak=ap.outerHeight();an=ap.outerWidth();ai=al.outerHeight();al.offset({top:am+ak-ai,left:aj+an+10})}else{if(ao==9){ak=ap.outerHeight();an=ap.outerWidth();ah=al.outerWidth();al.offset({top:am+ak+5,left:aj-ah/2+an/2})}}}}}}}}}}function u(ai){if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){return}var ak=Fai.top.$("#module"+ai.id),al=w.getActivePart(ai.id),ah=w.getStatus(ai.id),aj=(al==1||al==2||al==3);if(ah&&al!=4){Site.removeMoveFrame("module"+ai.id);Site.addMoveFrame("module"+ai.id)}else{if(ah&&!aj){Site.removeMoveFrame("module"+ai.id)}}Site.refreshResizableHandles(ak)}function p(ai){var ak=Fai.top.$("#module"+ai.id),al=w.getActivePart(ai.id),ah=w.getStatus(ai.id),aj=(al==1||al==2||al==3);if(aj){E(ai.id)}else{Site.removeMoveFrame("module"+ai.id)}}function E(ai){var ah=Fai.top.$("#module"+ai);Site.addMoveFrame("module"+ai);if(ah.data("bottomLine")==1){Fai.top.$("#module"+ai+"moveFrameBottom").css({opacity:1})}if(ah.data("topLine")==1){Fai.top.$("#module"+ai+"moveFrameTop").css({opacity:1})}if(ah.data("leftLine")==1){Fai.top.$("#module"+ai+"moveFrameLeft").css({opacity:1})}if(ah.data("rightLine")==1){Fai.top.$("#module"+ai+"moveFrameRight").css({opacity:1})}}function Z(ah){if(!Fai.top._canDesign){return}if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){X(ah.id);if(M("#module"+ah.id).data("simpleText")){M("#fkEditor-toolBar-"+ah.id).css("display","none")}return}af(ah.id);if(w.getActivePart(ah.id)==4){Q(ah.id)}}function t(ah){Y(ah.id,"initDrag");var ai=setTimeout(function(){if(!w.getStatus(ah.id)){X(ah.id)}else{if(w.getActivePart(ah.id)==4){Q(ah.id)}}},100);y(ah.id,"initDrag",ai)}function ac(ah){if(!Fai.top._canDesign){return}if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){P(ah.id);return}if(w.getStatus(ah.id)&&w.getActivePart(ah.id)!=4){if(!Fai.top.$("#module"+ah.id).hasClass("formStyle85")){G(ah.id)}if(!Fai.top.$("#module"+ah.id).hasClass("formStyle98")){G(ah.id)}}else{P(ah.id)}}function a(ah){Y(ah.id,"initResizeCancel_mouseleave");var ai=setTimeout(function(){!w.getStatus(ah.id)&&P(ah.id)},100);y(ah.id,"initResizeCancel_mouseleave",ai)}function F(ah){Fai.top.$("#module"+ah.id).delegate(".J_resizableTip","mouseover.resizeCancelBtn",function(){w.isActive(ah.id,"resizeCancel");w.lock(ah.id);Y(ah.id,"resizeCancelBtnMouseover");Y(ah.id,"resizeCancelBtnMouseleave");var ai=setTimeout(function(){if(w.getActivePart(ah.id)==3){X(ah.id);ag(ah.id,400)}},300);y(ah.id,"resizeCancelBtnMouseover",ai)}).delegate(".J_resizableTip","mouseleave.resizeCancelBtn",function(){w.open(ah.id);w.isLeave(ah.id);Y(ah.id,"resizeCancelBtnMouseover");Y(ah.id,"resizeCancelBtnMouseleave");var ai=setTimeout(function(){if(w.getStatus(ah.id)&&w.getActivePart(ah.id)!=4){O(ah.id);ae(ah.id)}},100);y(ah.id,"resizeCancelBtnMouseleave",ai)})}function l(ah){if(!Fai.top._canDesign){return}if(o(ah.id)){return}if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){B(ah.id);return}if(w.getStatus(ah.id)&&w.getActivePart(ah.id)!=4){ab(ah.id)}else{B(ah.id)}}function A(ah){var ai=setTimeout(function(){!w.getStatus(ah.id)&&B(ah.id)},100)}function j(ai){var ak=Fai.top.$("#module"+ai.id);if(!Fai.isNull(Site._enableEditLayer)&&!Site._enableEditLayer){Site.removeMoveFrame("module"+ai.id);ak.children(".ui-resizable-handle").hide();return}var al=w.getActivePart(ai.id),ah=w.getStatus(ai.id),aj=(al==1||al==2||al==3);if(ah&&al!=4){ak.children(".ui-resizable-handle").removeClass("fk-childModuleHover").show()}else{if(ah&&al==4){ak.children(".ui-resizable-handle").addClass("fk-childModuleHover").show()}else{if(ah&&!aj){ak.children(".ui-resizable-handle").hide()}}}}function s(aC){var aB=Fai.top.$("#fk-moduleToolbar"+aC);if(aB.length<0){return}var ak=Fai.top.$("#module"+aC),aQ=I(ak),at=Site.checkModuleInZone(ak),aA=ak.outerWidth(),aj=ak.outerHeight(),aF=ak.offset(),ap=aF.left,ar=aF.top,aH=ap+aA,ah=ar+aj,aO=Fai.top.$(".floatRightBottom").offset(),aE=Fai.top.$(".floatLeftTop").offset(),aN=aO.left,aP=aO.top,an=Fai.getScrollWidth(),aD=Fai.top.$("#g_main"),aR=aD.scrollTop(),aM=aB.outerWidth(),aK=aB.outerHeight(),al=0,aw=0,aJ=0,az=false,ao="",au=false,aG=false,ay=0,aq,av,am,aI,ai;ax();function aL(){if(aQ.isFullmeasure){al=aN-aM;aw=ar-aK;ao="fk-moduleToolbar-left";if(aw<aE.top){aw=aE.top}aB.css({right:an+"px",top:aw+"px"})}else{if(ak.find(".formMiddleContent"+aC).children(".pd_mall_G_J").length>0||ak.find(".formMiddleContent"+aC).children(".navA_C_J").length>0){au=true}if(aH<=(aN-aM)&&!aQ.inMulCol&&!aQ.inTab&&!au){al=aH;aw=ar;ao="fk-moduleToolbar-right";ay=2}else{if(ap>=aM){al=ap-aM;aw=ar;ao="fk-moduleToolbar-left";aG=true;ay=1}else{if((ar-aE.top)>=38){ao="fk-moduleToolbar-top";aB.removeClass("fk-moduleToolbar-left fk-moduleToolbar-right fk-moduleToolbar-top fk-moduleToolbar-bottom").addClass(ao);aM=aB.outerWidth();aK=aB.outerHeight();al=aH-aM;aw=ar-aK;ay=3}else{if((ah+38)<=aP){ao="fk-moduleToolbar-bottom";aB.removeClass("fk-moduleToolbar-left fk-moduleToolbar-right fk-moduleToolbar-top fk-moduleToolbar-bottom").addClass(ao);aM=aB.outerWidth();aK=aB.outerHeight();al=aH-aM;aw=ah;ay=4}else{al=ap;aw=ar;ao="fk-moduleToolbar-left";aG=true;ay=5}}}}if(aQ.inPack||at){if(at){aq=ak.parent()}else{aq=Fai.top.$("#module"+aQ.inPackId)}aI=aq.offset().left;ai=aq.offset().top;av=aI+aq.width();am=ai+aq.height();if(ay==2){if(al>av){al=av}if(aw<ai){aw=ai}}else{if(ay==1){if(al<aI){if(ap<aI){al=aI-aM}else{al=ap-aM}}if(aw<ai){aw=ai}}else{if(ay==3){if(aw<ai){tooTop=ai}if((al+aM)>av){al=av-aM}}else{if(ay==4){if((aM+al)>av){al=av-aM}if((aw+aK)>am){aw=am-aK}}else{if(ay==5){if(al<aI){al=aI-aM;if(al<0){al=aI}}if(aw<ai){aw=ai}}}}}}}switch(ay){case 1:case 2:if(aP<(aw+aK)){az=true;aJ=0}else{if(aw<aE.top){aw=aE.top}}break;case 3:case 4:case 5:if(al<0){al=0}else{if((al+aM)>(aN-an)){al=aN-aM-an}}if(aw<aE.top){aw=aE.top}break;default:}if(az){aB.css({left:al+"px",bottom:aJ+"px"})}else{aB.css({left:al+"px",top:aw+"px"})}if(aQ.isMultiModule||aQ.isPack){var aT=document.createElement("div"),aS="fk-multiDragBtn-left";if(typeof aT.style.borderRadius=="undefined"){aS+=" fk-multiDragBtn-left-low";aT=null}if(aQ.isTab){aG?ak.find(".J_tabHandle").addClass(aS):ak.find(".J_tabHandle").removeClass(aS)}else{if(aQ.isMulCol){aG?ak.find(".J_multiHandle").addClass(aS):ak.find(".J_multiHandle").removeClass(aS)}else{if(aQ.isPack){aG?ak.find(".J_packHandle").addClass(aS):ak.find(".J_packHandle").removeClass(aS)}}}}}aB.removeClass("fk-moduleToolbar-left fk-moduleToolbar-right fk-moduleToolbar-top fk-moduleToolbar-bottom").addClass(ao)}function ax(){var aV,aU="fk-multiDragBtn-left",aT,aS,aX=0,aW=0;if((aQ.isMultiModule||aQ.isPack)&&(aQ.inMulCol||aQ.inTab)){aV=document.createElement("div");aG=true;if(typeof aV.style.borderRadius=="undefined"){aU+=" fk-multiDragBtn-left-low";aV=null}}if(aQ.isTab&&!aQ.isTabY){aG?ak.find(".J_tabHandle").addClass(aU):ak.find(".J_tabHandle").removeClass(aU)}else{if(aQ.isMulCol){aG?ak.find(".J_multiHandle").addClass(aU):ak.find(".J_multiHandle").removeClass(aU)}else{if(aQ.isPack){aG?ak.find(".J_packHandle").addClass(aU):ak.find(".J_packHandle").removeClass(aU)}}}if(aQ.isTabY){ak.find(".J_tabHandle").addClass(aU);aG=true}aw=ar-aK-4;al=aG?ap:(aH-aM);if(aQ.inPack||at){if(at){aq=ak.parent()}else{aq=Fai.top.$("#module"+aQ.inPackId);aS=aq.find(".formBanner"+aQ.inPackId);if(aS.is(":visible")){aX=aS.height()}}aI=aq.offset().left;ai=aq.offset().top+aX;av=aI+aq.width();am=ai+aq.height();if((aM+al)>av){al=av-aM}if(ar<ai){aw=ai-aK-4}}if(aw<aE.top){if(aj<100){aw=ar+aj+4}else{aw=aE.top}}if((aQ.isMultiModule||aQ.isPack)&&(ar+aR<=aE.top+aK)){aT=ak.find(">.J_dragHandle");if(aT.hasClass("fk-multiDragBtn-left")){al=al+aT.width()}else{al=al-aT.width()}}if(al<0){al=0}else{if((al+aM)>(aN-an)){al=aN-aM-an}}if(aQ.isFullmeasure){if(Fai.top.$("#J_WebRightBar").is(":visible")){aW=Fai.top.$("#J_WebRightBarList").outerWidth()+1;M(ak).find(">.J_fullmeasureHandle").addClass("fk-fullmeasureDragBtn-rightbar")}else{aW=0;M(ak).find(">.J_fullmeasureHandle").removeClass("fk-fullmeasureDragBtn-rightbar")}aB.css({right:an+aW+"px",top:aw+"px"})}else{aB.css({left:al+"px",top:aw+"px"})}}}function C(ah){var ai=Fai.top.$("#module"+ah.id),ak=I(ai),am=-1,al,aj;if(ak.inTabId>0){am=ak.inTabId}else{if(ak.inMulColId>0){am=ak.inMulColId}else{if(ak.inFullmeasureId>0){am=ak.inFullmeasureId}else{if(ak.inPackId>0){am=ak.inPackId}}}}U(ah.id);x(ah.id);q(ai,ah.id);X(ah.id);P(ah.id);if(!w.getContextMenu(ah.id)){Site.removeMoveFrame("module"+ah.id)}if(ai.attr("_side")=="2"&&ai.attr("_flutterSwitch")!="true"){Site.startFlutterInterval(ai);w.clearAll(ah.id)}else{if(ai.attr("_side")=="1"){Y(ah.id,"leaveSideModule");al=setTimeout(function(){if(!w.getStatus(ah.id)&&!w.getContextMenu(ah.id)&&Fai.top.$(".fk-moduleContextMenu"+ah.id).length<1&&Fai.top.$(".moduleMaskContainer").length<1){Site.reSetSidePosition(ai);w.clearAll(ah.id)}},300);y(ah.id,"leaveSideModule",al)}else{w.clearAll(ah.id)}}if(am>0&&!w.getStatus(am)){Y(am,"leaveParentModule");aj=setTimeout(function(){var an=Fai.top.$("#module"+ah.id),ao=I(an),ap=-1;if(ao.inTabId>0){ap=ao.inTabId}else{if(ao.inMulColId>0){ap=ao.inMulColId}else{if(ao.inFullmeasureId>0){ap=ao.inFullmeasureId}else{if(ao.inPackId>0){ap=ao.inPackId}}}}if(ao.inPackId>0&&Fai.top.$("#module"+ap).attr("_side")==1){return}C({id:ap})},300);y(am,"leaveParentModule",aj)}}function I(aj){if(Object.prototype.toString.call(aj).toLowerCase()!="[object object]"){throw new Error("Site.moduleEditTool getModuleData 参数错误");return}var ao=false,ah=false,au=0,ai=false,am=false,an=false,at=0,ax=false,ak=false,ar=0,ap=false,aw=false,al=false,av=false,aq=0;if(aj.hasClass("formStyle80")){ao=true}else{if(aj.hasClass("formStyle35")){ax=true}else{if(aj.hasClass("formStyle29")){ai=true;if(aj.hasClass("fk-formTabY")){am=true}}else{if(aj.hasClass("formStyle87")){al=true}}}}au=aj.attr("_infullmeasure")||0;if(au>0){ah=true}at=aj.attr("_intab")||0;if(at>0){an=true}ar=aj.attr("_inmulmcol")||0;if(ar>0){ak=true}aq=parseInt(aj.attr("_inpack"))||0;if(aq>0){av=true}if(ai||ax){ap=true}if(an||ak){aw=true}return{isFullmeasure:ao,inFullmeasure:ah,inFullmeasureId:au,isTab:ai,isTabY:am,inTab:an,inTabId:at,isMulCol:ax,inMulCol:ak,inMulColId:ar,isMultiModule:ap,inMultiModule:aw,isPack:al,inPack:av,inPackId:aq}}function af(ai){var aj=Fai.top.$("#module"+ai);if(aj.length<1){return}var am=I(aj),ap=false;function aq(av,aw){return aw.indexOf(parseInt(av.attr("_modulestyle")))>-1}function al(ax,aw){var av=Site.getModuleStatus(ax);if(aw.indexOf(av)>-1){return true}return false}function ar(aw){var av=aw.find(".J_moduleTmpMask");if(av.length!==0){av.off("mousemove.removeMask mousedown.removeMask");M("body").off("mouseup.changeFlag");aw.removeData("isModuleDown");av.remove()}}function at(aw){var av=aw.find(".J_moduleTmpMask");if(av.length===0){av=M("<div class='J_moduleTmpMask fk-moduleTmpMask'></div>");av.off("mousemove.removeMask mousedown.removeMask").on("mousemove.removeMask mousedown.removeMask",function(){if(!aw.data("isModuleDown")){ar(aw);aw.find(".J_dragHandle").show()}});M("body").off("mouseup.changeFlag").on("mouseup.changeFlag",function(){var ax=M("body");if(ax.length>0){aw.removeData("isModuleDown");ax.off("mouseup.changeFlag")}});aj.find("iframe").parent().append(av)}}if(!am.isMultiModule&&!am.isFullmeasure&&!am.isPack){if(aj.hasClass("formStyle18")||aj.hasClass("formStyle36")||aj.hasClass("formStyle17")||aj.hasClass("formStyle20")||aj.hasClass("formStyle72")){if(aj.find(".formBanner").is(":visible")){return}}else{return}if(aj.children(".draggableBtn").find(".J_handle").length<1){var an=[],au=30,ak=aj.width()/2-au;an.push("<div class='J_dragHandle draggableBtn' _mouseIn='0' style='left:"+ak+"px;'>");an.push("<a href='javascript:;' onclick='return false;' class='J_handle dragHandle'></a>");an.push("</div>");aj.append(an.join(""));if(aq(aj,[20,72,18])){if(al(ai,[2,3,4])){aj.find(".J_dragHandle").off("mousedown.createMask").on(" mousedown.createMask",function(){aj.removeData("isModuleDown");ar(aj);aj.data("isModuleDown",true);at(aj)})}else{if(al(ai,[1])){aj.off("mousedown.createMask").on(" mousedown.createMask",function(){aj.removeData("isModuleDown");ar(aj);aj.data("isModuleDown",true);at(aj)})}}}aj.off("Fai_onModuleSizeChange.dragBtn").off("Fai_onModuleLayoutChange.dragBtn").on("Fai_onModuleSizeChange.dragBtn",function(){Site.fixDragBtnPos(M(this))}).on("Fai_onModuleLayoutChange.dragBtn",function(){Site.fixDragBtnPos(M(this))});ap=true}}else{var ah=document.createElement("div"),ao="fk-multiDragBtn";if(typeof ah.style.borderRadius=="undefined"){ao="fk-multiDragBtn-low";ah=null}if(am.isMulCol&&aj.find(".J_multiHandle").length<1){aj.append('<div class="J_dragHandle J_multiHandle '+ao+'" title="按住鼠标，可随意拖动多列排版模块布局。"></div>');ap=true}else{if(am.isTab&&aj.find(".J_tabHandle").length<1){if(am.isTabY){ao+=" fk-multiDragBtn-left "}aj.append('<div class="J_dragHandle J_tabHandle '+ao+'" title="按住鼠标，可随意拖动标签模块布局。"></div>');aj.find(".formTabButton").attr("title","按住鼠标，可随意调整标签模块内模块顺序");aj.find(".formTab").addClass("column");ap=true}else{if(am.isFullmeasure&&aj.find(".J_fullmeasureHandle").length<1){aj.append('<div class="J_dragHandle J_fullmeasureHandle fk-fullmeasureDragBtn" title="按住鼠标，可随意拖动通栏模块布局。"></div>');ap=true}else{if(am.isPack&&aj.find(".J_packHandle").length<1){aj.append('<div class="J_dragHandle J_packHandle f-packHandle '+ao+'" title="按住鼠标，可随意拖动自由容器布局。"></div>');ap=true}}}}}if(ap){Site.addDragBtnHandle(aj);i(ai)}else{Site.fixDragBtnPos(aj)}ae(ai)}function X(aj){var ah=Fai.top.$("#module"+aj);if(ah.length<1){return}var ai=I(ah);if(ai.isTab){ah.find(".J_tabHandle").hide()}else{if(ai.isMulCol){ah.find(".J_multiHandle").hide()}else{if(ai.isFullmeasure){ah.find(".J_fullmeasureHandle").hide()}else{if(ai.isPack){ah.find(".J_packHandle").hide()}else{ah.children(".draggableBtn").hide()}}}}}function Q(ak){var ai=Fai.top.$("#module"+ak);if(ai.length<1){return}var aj=I(ai),ah="fk-halfHide";if(aj.isTab){ai.find(".J_tabHandle").addClass("fk-halfHide")}else{if(aj.isMulCol){ai.find(".J_multiHandle").addClass("fk-halfHide")}else{if(aj.isFullmeasure){ai.find(".J_fullmeasureHandle").addClass("fk-halfHide")}else{if(aj.isPack){ai.find(".J_packHandle").addClass("fk-halfHide")}else{ai.children(".draggableBtn").addClass("fk-halfHide")}}}}}function ae(aj){var ah=Fai.top.$("#module"+aj);if(ah.length<1){return}var ai=I(ah);if(ai.isTab){ah.find(".J_tabHandle").stop().removeClass("fk-halfHide").show()}else{if(ai.isMulCol){ah.find(".J_multiHandle").stop().removeClass("fk-halfHide").show()}else{if(ai.isFullmeasure){ah.find(".J_fullmeasureHandle").stop().removeClass("fk-halfHide").show()}else{if(ai.isPack){ah.find(".J_packHandle").stop().removeClass("fk-halfHide").show()}else{ah.children(".draggableBtn").stop().removeClass("fk-halfHide").show()}}}}}function ag(ai,ah){if(typeof ah=="number"){Fai.top.$("#fk-moduleToolbar"+ai).stop().fadeOut(ah)}else{Fai.top.$("#fk-moduleToolbar"+ai).stop().hide()}}function O(ah){Fai.top.$("#fk-moduleToolbar"+ah).stop().css("opacity",1).show()}function i(ak){var ai=Fai.top.$("#module"+ak);if(ai.length<1){return}var aj=I(ai),ah;if(aj.isTab){ah=ai.find(".J_tabHandle")}else{if(aj.isMulCol){ah=ai.find(".J_multiHandle")}else{if(aj.isFullmeasure){ah=ai.find(".J_fullmeasureHandle")}else{if(aj.isPack){ah=ai.find(".J_packHandle")}else{ah=ai.children(".draggableBtn")}}}}ah.off("mouseover.moduleEdit").off("mouseleave.moduleEdit").on("mouseover.moduleEdit",function(al){w.isActive(ak,"dragBtn");w.lock(ak);Y(ak,"dragBtnMouseover");var am=setTimeout(function(){var an=I(Fai.top.$("#module"+ak));if(an.isMultiModule||an.isFullmeasure||an.isPack){O(ak);G(ak)}else{if(w.getActivePart(ak)==2){ag(ak,400);P(ak)}}Y(ak,"dragBtnMouseover")},300);y(ak,"dragBtnMouseover",am)}).on("mouseleave.moduleEdit",function(al){w.open(ak);w.isLeave(ak);Y(ak,"dragBtnMouseover");var am=setTimeout(function(){if(w.getStatus(ak)&&w.getActivePart(ak)!=4){O(ak);G(ak)}},100);y(ak,"dragBtnMouseleave",am)})}function G(aj){var ah=Fai.top.$("#module"+aj),ai=ah.children(".J_resizableTip");if(ah.length<1){return}ai.show()}function P(aj){var ah=Fai.top.$("#module"+aj),ai=ah.children(".J_resizableTip");if(ah.length<1){return}ai.hide()}function ab(ai){var ah=Fai.top.$("#module"+ai);if(ah.length<1){return}ah.children(".J_lockEditTip").show()}function B(ai){var ah=Fai.top.$("#module"+ai);if(ah.length<1){return}ah.children(".J_lockEditTip").hide()}function o(ai){var ah=Fai.top.$("#module"+ai);if(ah.length<1){return}if(ah.data("lockedit")!="lock"){ah.children(".J_lockEditTip").remove();return true}else{return false}}function y(aj,ah,ai){L[aj]=L[aj]||{};L[aj][ah]=ai}function Y(ai,ah){if(L[ai]&&L[ai][ah]){clearTimeout(L[ai][ah]);delete L[ai][ah]}}function U(ai){var ah;if(L[ai]){for(ah in L[ai]){if(L[ai].hasOwnProperty(ah)){clearTimeout(L[ai][ah]);delete L[ai][ah]}}delete L[ai]}}function S(){var ah;for(ah in L){if(L.hasOwnProperty(ah)){U(ah)}}L=[]}function f(){Fai.top.$("#fk-moduleEditToolGuide").remove()}function n(ai){var ah=ai.name||"",aj=ai.value,ak=ai.time||90;if(window.localStorage&&window.localStorage.setItem){window.localStorage.setItem(ah,aj)}else{M.cookie("moduleEditToolPrompt","1",{expires:ak,path:"/"})}}function k(ai){var ah=ai.name||"",aj=false;if(window.localStorage&&window.localStorage.getItem){aj=window.localStorage.getItem(ah)}else{aj=M.cookie("moduleEditToolPrompt",{path:"/"})}return aj}function T(ak){var ah=Fai.top.$("#module"+ak),aj=v(ak),ai=Site.checkNestModule(ah);ah.data("lockedit","lock");Site.removeMoveFrame("module"+ak);Site.addMoveFrame("module"+ak);ah.addClass("formLockEdit");if(ai.nest){ah.find(".form").data("lockedit","lock").addClass("formLockEdit")}if(ai.inPack){ah.resizable("destroy");ah.children(".ui-resizable-cancelTip").remove()}else{if(aj==1){Site.dockModuleResize_disable(ah)}else{ah.draggable("destroy");ah.resizable("destroy");ah.children(".ui-resizable-cancelTip").remove()}}if(ai.isPack){jzUtils.run({name:"_elemZone.packChildrenDisableResizable",base:Fai.top},ah)}ah.append("<a href='javascript:;' onclick='Site.moduleEditTool.clickForOpenEdit("+ak+");return false;' class='J_lockEditTip fk-setEditTip fk-lockEditTip' title='解锁当前排版'></a>")}function m(ak){var ah=Fai.top.$("#module"+ak),aj=v(ak),ai=Site.checkNestModule(ah);ah.removeData("lockedit");Site.removeMoveFrame("module"+ak);Site.addMoveFrame("module"+ak);ah.removeClass("formLockEdit");if(ai.nest){ah.find(".form").removeData("lockedit").removeClass("formLockEdit")}if(ai.inPack){jzUtils.run({name:"_elemZone.resizeZoneOneModule",base:Fai.top},ah)}else{if(aj==1){Site.dockModuleResize(ah)}else{Site.floatModuleDraggable(ah)}if(ai.isPack){jzUtils.run({name:"_elemZone.resizeOneZoneModule",base:Fai.top},ah)}}}function v(aj){var ai=1,ah="module"+aj;if(Site.getFlutterStatus2(ah)==0){ai=4}else{if(Site.getSideStatus(ah)==0){ai=5}else{if(Site.getLockStatus(ah)==0){ai=3}else{if(Site.getAbsStatus(ah)==0){ai=2}}}}return ai}function N(an,ai){return;var aj=false,aq={},ao={},ap=Site.checkNestModule(an),am=["absTopForms","absForms","absBottomForms","floatLeftTopForms","floatRightTopForms","floatLeftBottomForms","floatRightBottomForms"],ah,ak,al;if(an.hasClass("J_checkModuleZIndexDone")||ap.inPack){return}if(ap.inPack){am=["fk-packContent"+ap.parentId]}else{ah=v(ai);if(ah!=2&&ah!=3){return}}aq.x=an.offset().left;aq.y=an.offset().top;aq.w=an.width();aq.h=an.height();aj=g({id:"module"+ai,rect1:aq,formsIdList:am});an.addClass("J_checkModuleZIndexDone");if(!aj){return}an.addClass("fk-maxModuleZindex");an.parent(".forms").addClass("fk-maxFormsZIndex");ak=Fai.top.$("#fk-moduleToolbar"+ai);if(ak.length>0){al=Site.getModuleAttrPattern(ai);if(al.border.y==1&&al.contentBg.y==1&&al.bannerType==1){an.addClass("fk-hoverModule")}}if(an.data("simpleText")&&!an.find("#fkEditor-"+ai).attr("contenteditable")){an.addClass("fk-hoverModule")}}function g(am){var aq=am.rect1,ai=am.id,ao=am.formsIdList,ak=false,ah,aj,an,ap;for(var al=0;al<ao.length;al++){ah=Fai.top.$("#"+ao[al]).children(".form");ah.each(function(ar,at){aj=M(at);if(aj.attr("id")==ai){return true}an=aj.offset();ap={};ap.w=aj.width();ap.h=aj.height();ap.x=an.left;ap.y=an.top;ak=e(aq,ap);if(ak){return false}});if(ak){break}}return ak}function q(ai,ah){ai.removeClass("fk-maxModuleZindex fk-hoverModule J_checkModuleZIndexDone");ai.parent(".forms").removeClass("fk-maxFormsZIndex")}function e(ai,ah){if(ah.x>=(ai.x+ai.w)){}else{if((ah.x+ah.w)<=ai.x){}else{if((ah.y+ah.h)<=ai.y){}else{if((ai.y+ai.h)<ah.y){}else{return true}}}}return false}})(jQuery,Site.moduleEditTool);